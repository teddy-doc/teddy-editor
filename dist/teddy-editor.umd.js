(function(x,ge){typeof exports=="object"&&typeof module<"u"?module.exports=ge(require("react")):typeof define=="function"&&define.amd?define(["react"],ge):(x=typeof globalThis<"u"?globalThis:x||self,x.TeddyEditor=ge(x.React))})(this,function(x){"use strict";var ge={exports:{}},Re={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Et;function sn(){if(Et)return Re;Et=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function a(o,l,s){var i=null;if(s!==void 0&&(i=""+s),l.key!==void 0&&(i=""+l.key),"key"in l){s={};for(var u in l)u!=="key"&&(s[u]=l[u])}else s=l;return l=s.ref,{$$typeof:r,type:o,key:i,ref:l!==void 0?l:null,props:s}}return Re.Fragment=e,Re.jsx=a,Re.jsxs=a,Re}var Ce={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nt;function an(){return Nt||(Nt=1,process.env.NODE_ENV!=="production"&&function(){function r(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===K?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case y:return"Fragment";case _:return"Profiler";case G:return"StrictMode";case O:return"Suspense";case he:return"SuspenseList";case U:return"Activity"}if(typeof c=="object")switch(typeof c.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),c.$$typeof){case I:return"Portal";case $:return(c.displayName||"Context")+".Provider";case W:return(c._context.displayName||"Context")+".Consumer";case C:var g=c.render;return c=c.displayName,c||(c=g.displayName||g.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case A:return g=c.displayName||null,g!==null?g:r(c.type)||"Memo";case Z:g=c._payload,c=c._init;try{return r(c(g))}catch{}}return null}function e(c){return""+c}function a(c){try{e(c);var g=!1}catch{g=!0}if(g){g=console;var k=g.error,w=typeof Symbol=="function"&&Symbol.toStringTag&&c[Symbol.toStringTag]||c.constructor.name||"Object";return k.call(g,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",w),e(c)}}function o(c){if(c===y)return"<>";if(typeof c=="object"&&c!==null&&c.$$typeof===Z)return"<...>";try{var g=r(c);return g?"<"+g+">":"<...>"}catch{return"<...>"}}function l(){var c=S.A;return c===null?null:c.getOwner()}function s(){return Error("react-stack-top-frame")}function i(c){if(D.call(c,"key")){var g=Object.getOwnPropertyDescriptor(c,"key").get;if(g&&g.isReactWarning)return!1}return c.key!==void 0}function u(c,g){function k(){Q||(Q=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",g))}k.isReactWarning=!0,Object.defineProperty(c,"key",{get:k,configurable:!0})}function m(){var c=r(this.type);return ee[c]||(ee[c]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),c=this.props.ref,c!==void 0?c:null}function f(c,g,k,w,se,v,ue,be){return k=v.ref,c={$$typeof:T,type:c,key:g,props:v,_owner:se},(k!==void 0?k:null)!==null?Object.defineProperty(c,"ref",{enumerable:!1,get:m}):Object.defineProperty(c,"ref",{enumerable:!1,value:null}),c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(c,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(c,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:ue}),Object.defineProperty(c,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:be}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}function E(c,g,k,w,se,v,ue,be){var M=g.children;if(M!==void 0)if(w)if(j(M)){for(w=0;w<M.length;w++)b(M[w]);Object.freeze&&Object.freeze(M)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else b(M);if(D.call(g,"key")){M=r(c);var de=Object.keys(g).filter(function(Ye){return Ye!=="key"});w=0<de.length?"{key: someKey, "+de.join(": ..., ")+": ...}":"{key: someKey}",ce[M+w]||(de=0<de.length?"{"+de.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,w,M,de,M),ce[M+w]=!0)}if(M=null,k!==void 0&&(a(k),M=""+k),i(g)&&(a(g.key),M=""+g.key),"key"in g){k={};for(var xe in g)xe!=="key"&&(k[xe]=g[xe])}else k=g;return M&&u(k,typeof c=="function"?c.displayName||c.name||"Unknown":c),f(c,M,v,se,l(),k,ue,be)}function b(c){typeof c=="object"&&c!==null&&c.$$typeof===T&&c._store&&(c._store.validated=1)}var R=x,T=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),$=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),K=Symbol.for("react.client.reference"),S=R.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=Object.prototype.hasOwnProperty,j=Array.isArray,P=console.createTask?console.createTask:function(){return null};R={"react-stack-bottom-frame":function(c){return c()}};var Q,ee={},te=R["react-stack-bottom-frame"].bind(R,s)(),re=P(o(s)),ce={};Ce.Fragment=y,Ce.jsx=function(c,g,k,w,se){var v=1e4>S.recentlyCreatedOwnerStacks++;return E(c,g,k,!1,w,se,v?Error("react-stack-top-frame"):te,v?P(o(c)):re)},Ce.jsxs=function(c,g,k,w,se){var v=1e4>S.recentlyCreatedOwnerStacks++;return E(c,g,k,!0,w,se,v?Error("react-stack-top-frame"):te,v?P(o(c)):re)}}()),Ce}var Tt;function ln(){return Tt||(Tt=1,process.env.NODE_ENV==="production"?ge.exports=sn():ge.exports=an()),ge.exports}var n=ln();/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),un=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,o)=>o?o.toUpperCase():a.toLowerCase()),_t=r=>{const e=un(r);return e.charAt(0).toUpperCase()+e.slice(1)},wt=(...r)=>r.filter((e,a,o)=>!!e&&e.trim()!==""&&o.indexOf(e)===a).join(" ").trim(),dn=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=x.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:s,iconNode:i,...u},m)=>x.createElement("svg",{ref:m,...fn,width:e,height:e,stroke:r,strokeWidth:o?Number(a)*24/Number(e):a,className:wt("lucide",l),...!s&&!dn(u)&&{"aria-hidden":"true"},...u},[...i.map(([f,E])=>x.createElement(f,E)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=(r,e)=>{const a=x.forwardRef(({className:o,...l},s)=>x.createElement(mn,{ref:s,iconNode:e,className:wt(`lucide-${cn(_t(r))}`,`lucide-${r}`,o),...l}));return a.displayName=_t(r),a};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=z("align-center",[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=z("align-justify",[["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 18h18",key:"1h113x"}],["path",{d:"M3 6h18",key:"d0wm0j"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=z("align-left",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=z("align-right",[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=z("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=z("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=z("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=z("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=z("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=z("list-ordered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=z("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=z("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=z("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=z("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=z("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=z("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=z("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=z("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=z("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ze=(r,e,a)=>{const o=window.getSelection();if(!o||o.rangeCount===0||!e.current)return;const l=o.getRangeAt(0);if(l.toString())try{const s=()=>{let f=l.commonAncestorContainer;for(;f&&f!==e.current;){if(f.nodeType===Node.ELEMENT_NODE){const E=f;if(E.tagName.toLowerCase()===r.toLowerCase())return{isFormatted:!0,formatElement:E}}f=f.parentNode}return{isFormatted:!1,formatElement:null}},{isFormatted:i,formatElement:u}=s();let m=null;if(i&&u){const f=u.parentNode,E=document.createTextNode(u.textContent||"");f?.replaceChild(E,u),f?.normalize();const b=document.createRange();b.selectNodeContents(E),o.removeAllRanges(),o.addRange(b)}else{m=document.createElement(r);try{l.surroundContents(m);const f=document.createRange();f.selectNodeContents(m),o.removeAllRanges(),o.addRange(f)}catch{const E=l.extractContents();m.appendChild(E),l.insertNode(m);const b=document.createRange();b.selectNodeContents(m),o.removeAllRanges(),o.addRange(b)}}a()}catch(s){console.warn("Error applying format:",s),a()}},At=({editorRef:r,activeFormats:e,updateActiveFormats:a,getButtonClass:o})=>n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>ze("strong",r,a),className:o(e.bold),title:"Bold",children:n.jsx(xn,{size:18})}),n.jsx("button",{onClick:()=>ze("em",r,a),className:o(e.italic),title:"Italic",children:n.jsx(En,{size:18})}),n.jsx("button",{onClick:()=>ze("u",r,a),className:o(e.underline),title:"Underline",children:n.jsx(Rn,{size:18})}),n.jsx("button",{onClick:()=>ze("s",r,a),className:o(e.strikethrough),title:"Strikethrough",children:n.jsx(vn,{size:18})})]}),Ue=(r,e)=>{const a=window.getSelection();if(!a||a.rangeCount===0)return;let l=a.getRangeAt(0).commonAncestorContainer;for(;l&&l.nodeType!==Node.ELEMENT_NODE;)l=l.parentNode;if(l&&l.nodeType===Node.ELEMENT_NODE){const s=l;s.style.textAlign=r==="left"?"":r,e()}},vt=({activeFormats:r,updateActiveFormats:e,getButtonClass:a})=>n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>Ue("left",e),className:a(r.alignLeft),title:"Align Left",children:n.jsx(hn,{size:18})}),n.jsx("button",{onClick:()=>Ue("center",e),className:a(r.alignCenter),title:"Align Center",children:n.jsx(pn,{size:18})}),n.jsx("button",{onClick:()=>Ue("right",e),className:a(r.alignRight),title:"Align Right",children:n.jsx(bn,{size:18})}),n.jsx("button",{onClick:()=>Ue("justify",e),className:a(r.alignJustify),title:"Justify",children:n.jsx(gn,{size:18})})]}),St=(r,e,a)=>{const o=window.getSelection();if(!o||o.rangeCount===0||!e.current)return;const l=o.getRangeAt(0);let s=l.commonAncestorContainer;s.nodeType===Node.TEXT_NODE&&(s=s.parentNode);let i=s;for(;i&&i!==e.current&&!["P","H1","H2","H3","H4","H5","H6","LI","UL","OL"].includes(i.tagName);)i=i.parentElement;if(!i||i===e.current){const u=document.createElement(r),m=document.createElement("li");m.textContent=o.toString()||"List item",u.appendChild(m),l.deleteContents(),l.insertNode(u);const f=document.createRange();f.setStart(m,0),f.setEnd(m,m.childNodes.length),o.removeAllRanges(),o.addRange(f)}else if(i.tagName==="LI"){const u=i.parentElement;if(u.tagName.toLowerCase()===r){const m=document.createElement("p");m.innerHTML=i.innerHTML,u.parentNode?.replaceChild(m,u)}else{const m=document.createElement(r);m.innerHTML=u.innerHTML,u.parentNode?.replaceChild(m,u)}}else{const u=document.createElement(r),m=document.createElement("li");m.innerHTML=i.innerHTML,u.appendChild(m),i.parentNode?.replaceChild(u,i)}a()},Rt=({editorRef:r,activeFormats:e,updateActiveFormats:a,getButtonClass:o})=>n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>{r?.current&&St("ul",r,a)},className:o(e.bulletList),title:"Bullet List",children:n.jsx(_n,{size:18})}),n.jsx("button",{onClick:()=>{r?.current&&St("ol",r,a)},className:o(e.numberedList),title:"Numbered List",children:n.jsx(Tn,{size:18})})]}),Ln=({editorRef:r,activeFormats:e,currentTextFormat:a,updateActiveFormats:o,applyTextFormat:l})=>{const[s,i]=x.useState({top:0,left:0}),[u,m]=x.useState(!1),[f,E]=x.useState(!1),b=x.useRef(null),R=[{value:"p",label:"Paragraph",tag:"p"},{value:"h1",label:"Heading 1",tag:"h1"},{value:"h2",label:"Heading 2",tag:"h2"},{value:"h3",label:"Heading 3",tag:"h3"},{value:"h4",label:"Heading 4",tag:"h4"},{value:"h5",label:"Heading 5",tag:"h5"},{value:"h6",label:"Heading 6",tag:"h6"}];x.useEffect(()=>{const y=()=>{const G=window.getSelection();if(!G||G.rangeCount===0||G.isCollapsed||!r.current||!r.current.contains(G.anchorNode)){m(!1),E(!1);return}const W=G.getRangeAt(0).getBoundingClientRect(),$=b.current?.offsetHeight||50,C=W.top-$-45,O=W.left+W.width/2;i({top:C,left:O}),m(!0)};return document.addEventListener("selectionchange",y),window.addEventListener("scroll",y,!0),window.addEventListener("resize",y),()=>{document.removeEventListener("selectionchange",y),window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",y)}},[r]);const T=y=>`p-1.5 rounded transition-colors ${y?"bg-blue-100 text-blue-600 hover:bg-blue-200":"text-gray-600 hover:bg-gray-100"}`,I=y=>{l(y),E(!1)};return u?n.jsxs("div",{ref:b,className:"fixed z-40 flex items-center gap-1 p-1 bg-white rounded-lg shadow-lg border border-gray-200 animate-in fade-in zoom-in-95 duration-200",style:{top:`${s.top}px`,left:`${s.left}px`,transform:"translateX(-50%)"},onMouseDown:y=>{y.preventDefault()},children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>E(!f),className:"flex items-center gap-1 px-2 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[100px] justify-between",children:[n.jsx("span",{className:"truncate max-w-[80px]",children:R.find(y=>y.value===a)?.label||"Paragraph"}),n.jsx(Pe,{size:12})]}),f&&n.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-xl overflow-hidden min-w-[140px] max-h-[300px] overflow-y-auto",children:R.map(y=>n.jsx("button",{onClick:()=>I(y.tag),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${a===y.value?"bg-blue-50 text-blue-600":"text-gray-700"}`,children:y.label},y.value))})]}),n.jsx("div",{className:"w-px h-5 bg-gray-200 mx-1"}),n.jsx(At,{editorRef:r,activeFormats:e,updateActiveFormats:o,getButtonClass:T}),n.jsx("div",{className:"w-px h-5 bg-gray-200 mx-1"}),n.jsx(Rt,{editorRef:r,activeFormats:{bulletList:e.bulletList,numberedList:e.numberedList},updateActiveFormats:o,getButtonClass:T}),n.jsx("div",{className:"w-px h-5 bg-gray-200 mx-1"}),n.jsx(vt,{activeFormats:{alignLeft:e.alignLeft,alignCenter:e.alignCenter,alignRight:e.alignRight,alignJustify:e.alignJustify},updateActiveFormats:o,getButtonClass:T})]}):null};let Ne=null;const $e=()=>{const r=window.getSelection();r&&r.rangeCount>0&&(Ne=r.getRangeAt(0).cloneRange())},qe=()=>{if(Ne){const r=window.getSelection();r?.removeAllRanges(),r?.addRange(Ne)}},et=()=>{const r=window.getSelection();if(!r||r.rangeCount===0)return null;let a=r.getRangeAt(0).commonAncestorContainer;a.nodeType===Node.TEXT_NODE&&(a=a.parentNode);let o=a;for(;o&&o!==document.body;){if(o.nodeType===Node.ELEMENT_NODE){const l=o,s=l.tagName.toLowerCase();if(s==="a")return{type:"link",url:l.getAttribute("href")||"",text:l.textContent||""};if(s==="img")return{type:"image",src:l.getAttribute("src")||"",alt:l.getAttribute("alt")||""};if(s==="iframe")return{type:"video",src:l.getAttribute("src")||""}}o=o.parentNode}return null},jn=(r,e)=>{qe();const a=window.getSelection();if(!a||a.rangeCount===0){const i=document.querySelector('[contenteditable="true"]');if(i){const u=document.createElement("a");u.href=r,u.textContent=e||r,u.target="_blank",u.rel="noopener noreferrer",u.className="text-blue-600 underline hover:text-blue-800",i.appendChild(u);const m=document.createTextNode(" ");i.appendChild(m);const f=document.createRange();f.setStartAfter(m),f.collapse(!0),a&&(a.removeAllRanges(),a.addRange(f))}return}const o=a.getRangeAt(0);let l=null,s=o.commonAncestorContainer;for(;s&&s!==document.body;){if(s.nodeType===Node.ELEMENT_NODE&&s.tagName.toLowerCase()==="a"){l=s;break}s=s.parentNode}if(l)l.setAttribute("href",r),l.textContent=e||r;else{const i=document.createElement("a");i.href=r,i.textContent=e||r,i.target="_blank",i.rel="noopener noreferrer",i.className="text-blue-600 underline hover:text-blue-800",o.deleteContents(),o.insertNode(i);const u=document.createRange();u.setStartAfter(i),u.collapse(!0),a.removeAllRanges(),a.addRange(u)}Ne=null},Mn=(r,e="Inserted image")=>{qe();const a=window.getSelection();if(!a||a.rangeCount===0){const i=document.querySelector('[contenteditable="true"]');if(i){const u=document.createElement("img");u.src=r,u.alt=e,u.className="max-w-full h-auto rounded shadow-sm",i.appendChild(u);const m=document.createElement("br");i.appendChild(m);const f=document.createRange();f.setStartAfter(m),f.collapse(!0),a&&(a.removeAllRanges(),a.addRange(f))}return}const o=a.getRangeAt(0);let l=null,s=o.commonAncestorContainer;for(;s&&s!==document.body;){if(s.nodeType===Node.ELEMENT_NODE&&s.tagName.toLowerCase()==="img"){l=s;break}s=s.parentNode}if(l)l.setAttribute("src",r),l.setAttribute("alt",e);else{const i=document.createElement("img");i.src=r,i.alt=e,i.className="max-w-full h-auto rounded shadow-sm",o.deleteContents(),o.insertNode(i);const u=document.createRange();u.setStartAfter(i),u.collapse(!0),a.removeAllRanges(),a.addRange(u)}Ne=null},On=r=>{qe();const e=window.getSelection();if(!e||e.rangeCount===0){const s=document.querySelector('[contenteditable="true"]');if(s){const i=document.createElement("iframe");i.src=r,i.width="560",i.height="315",i.className="max-w-full rounded shadow-sm",i.setAttribute("frameborder","0"),i.setAttribute("allowfullscreen","true"),i.setAttribute("sandbox","allow-scripts allow-same-origin allow-presentation"),s.appendChild(i);const u=document.createElement("br");s.appendChild(u);const m=document.createRange();m.setStartAfter(u),m.collapse(!0),e&&(e.removeAllRanges(),e.addRange(m))}return}const a=e.getRangeAt(0);let o=null,l=a.commonAncestorContainer;for(;l&&l!==document.body;){if(l.nodeType===Node.ELEMENT_NODE&&l.tagName.toLowerCase()==="iframe"){o=l;break}l=l.parentNode}if(o)o.setAttribute("src",r);else{const s=document.createElement("iframe");s.src=r,s.width="560",s.height="315",s.className="max-w-full rounded shadow-sm",s.setAttribute("frameborder","0"),s.setAttribute("allowfullscreen","true"),s.setAttribute("sandbox","allow-scripts allow-same-origin allow-presentation"),a.deleteContents(),a.insertNode(s);const i=document.createRange();i.setStartAfter(s),i.collapse(!0),e.removeAllRanges(),e.addRange(i)}Ne=null},In=({isOpen:r,onClose:e,onInsert:a,initialData:o})=>{const[l,s]=x.useState(""),[i,u]=x.useState("");x.useEffect(()=>{r&&o?(s(o.url),u(o.text)):r&&!o&&(s(""),u(""))},[r,o]);const m=f=>{f.preventDefault(),l.trim()&&(a(l.trim(),i.trim()),s(""),u(""),e())};return r?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold",children:o?"Edit Link":"Insert Link"}),n.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:n.jsx(He,{size:20})})]}),n.jsxs("form",{onSubmit:m,children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL"}),n.jsx("input",{type:"url",value:l,onChange:f=>s(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com",required:!0,autoFocus:!0})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link Text (optional)"}),n.jsx("input",{type:"text",value:i,onChange:f=>u(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Link text"})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:o?"Update Link":"Insert Link"})]})]})]})}):null},Dn=({isOpen:r,onClose:e,onInsert:a,initialData:o})=>{const[l,s]=x.useState(""),[i,u]=x.useState(""),m=x.useRef(null);x.useEffect(()=>{r&&o?(s(o.alt),u(o.src)):r&&!o&&(s(""),u(""))},[r,o]);const f=R=>{const T=R.target.files?.[0];if(T){const I=new FileReader;I.onload=y=>{const G=y.target?.result;a(G,l||T.name),s(""),u(""),e(),m.current&&(m.current.value="")},I.readAsDataURL(T)}},E=()=>{o&&i&&(a(i,l),s(""),u(""),e())},b=()=>{m.current&&m.current.click()};return r?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold",children:o?"Edit Image":"Insert Image"}),n.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:n.jsx(He,{size:20})})]}),o&&n.jsxs("div",{className:"mb-4",children:[n.jsx("img",{src:i,alt:l,className:"max-w-full h-32 object-contain rounded border"}),n.jsx("button",{type:"button",onClick:b,className:"mt-2 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Replace Image"})]}),n.jsx("input",{ref:m,type:"file",accept:"image/*",onChange:f,className:"hidden"}),!o&&n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image File"}),n.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alt Text (optional)"}),n.jsx("input",{type:"text",value:l,onChange:R=>s(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Image description",autoFocus:!!o})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),o&&n.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Update Image"})]})]})}):null},Pn=({isOpen:r,onClose:e,onInsert:a,initialData:o})=>{const[l,s]=x.useState(""),[i,u]=x.useState("");x.useEffect(()=>{r&&o?s(o.src):r&&!o&&s(""),u("")},[r,o]);const m=E=>{const b=E.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([\w-]+)/);if(b)return`https://www.youtube.com/embed/${b[1]}`;const R=E.match(/vimeo\.com\/(?:video\/)?(\d+)/);return R?`https://player.vimeo.com/video/${R[1]}`:E.includes("youtube.com/embed/")||E.includes("player.vimeo.com/video/")?E:null},f=E=>{if(E.preventDefault(),u(""),l.trim()){const b=m(l.trim());b?(a(b),s(""),e()):u("Invalid URL. Only YouTube and Vimeo are supported for security.")}};return r?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold",children:o?"Edit Video":"Insert Video"}),n.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:n.jsx(He,{size:20})})]}),n.jsxs("form",{onSubmit:f,children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Video URL"}),n.jsx("input",{type:"url",value:l,onChange:E=>s(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"YouTube, Vimeo, or embed URL",required:!0,autoFocus:!0}),i&&n.jsx("p",{className:"text-sm text-red-500 mt-1",children:i}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supports YouTube, Vimeo, and direct embed URLs"})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:o?"Update Video":"Insert Video"})]})]})]})}):null},Hn=()=>{const[r,e]=x.useState(!1),[a,o]=x.useState(!1),[l,s]=x.useState(!1),[i,u]=x.useState(null),m=()=>{$e();const b=et();u(b?.type==="link"?b:null),e(!0)},f=()=>{$e();const b=et();u(b?.type==="image"?b:null),o(!0)},E=()=>{$e();const b=et();u(b?.type==="video"?b:null),s(!0)};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:m,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Link",children:n.jsx(Nn,{size:18})}),n.jsx("button",{onClick:f,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Image",children:n.jsx(yn,{size:18})}),n.jsx("button",{onClick:E,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Video",children:n.jsx(kn,{size:18})})]}),n.jsx(In,{isOpen:r,onClose:()=>{e(!1),u(null)},onInsert:jn,initialData:i?.type==="link"?{url:i.url,text:i.text}:null}),n.jsx(Dn,{isOpen:a,onClose:()=>{o(!1),u(null)},onInsert:Mn,initialData:i?.type==="image"?{src:i.src,alt:i.alt}:null}),n.jsx(Pn,{isOpen:l,onClose:()=>{s(!1),u(null)},onInsert:On,initialData:i?.type==="video"?{src:i.src}:null})]})},zn=({getButtonClass:r,onUndo:e,onRedo:a,canUndo:o,canRedo:l})=>{const s=u=>{u.preventDefault(),o&&e()},i=u=>{u.preventDefault(),l&&a()};return n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onMouseDown:s,className:`${r(!1)} ${o?"":"opacity-50 cursor-not-allowed"}`,title:"Undo",disabled:!o,children:n.jsx(Cn,{size:18})}),n.jsx("button",{onMouseDown:i,className:`${r(!1)} ${l?"":"opacity-50 cursor-not-allowed"}`,title:"Redo",disabled:!l,children:n.jsx(An,{size:18})})]})},Un=({getButtonClass:r,updateActiveFormats:e})=>{const[a,o]=x.useState(!1),[l,s]=x.useState(!1),[i,u]=x.useState(!1),[m,f]=x.useState(""),E=["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff","#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff","#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc","#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd","#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0","#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],b=[{name:"Sans Serif",value:"Arial, Helvetica, sans-serif"},{name:"Serif",value:"Times New Roman, Times, serif"},{name:"Monospace",value:"Courier New, Courier, monospace"}],R=[8,9,10,11,12,14,18,24,30,36,48,60,72,96],T=_=>{document.execCommand("foreColor",!1,_),o(!1),e()},I=_=>{document.execCommand("fontName",!1,_),s(!1),e()},y=_=>{document.execCommand("fontSize",!1,"7");const W=document.getElementsByTagName("font");for(let $=W.length-1;$>=0;$--){const C=W[$];if(C.getAttribute("size")==="7"){const O=document.createElement("span");O.style.fontSize=`${_}px`,O.innerHTML=C.innerHTML,C.parentNode?.replaceChild(O,C)}}u(!1),f(""),e()},G=_=>{_.preventDefault(),m&&y(m)};return n.jsxs("div",{className:"flex gap-1 items-center relative",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>s(!l),onBlur:()=>setTimeout(()=>s(!1),200),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[100px] justify-between transition-colors",title:"Font Family",children:[n.jsx("span",{className:"font-medium truncate max-w-[80px]",children:"Font"}),n.jsx(Pe,{size:14,className:"text-gray-500"})]}),l&&n.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 min-w-[160px]",children:b.map(_=>n.jsx("button",{onMouseDown:W=>{W.preventDefault(),I(_.value)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 font-medium",style:{fontFamily:_.value},children:_.name},_.name))})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>u(!i),onBlur:()=>{setTimeout(()=>{u(!1)},200)},className:"flex items-center gap-2 px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[60px] justify-between transition-colors",title:"Font Size",children:[n.jsx("span",{className:"font-medium",children:"Size"}),n.jsx(Pe,{size:14,className:"text-gray-500"})]}),i&&n.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 min-w-[100px] max-h-[300px] overflow-y-auto",onMouseDown:_=>_.preventDefault(),children:[n.jsx("div",{className:"p-2 border-b border-gray-100",children:n.jsxs("form",{onSubmit:G,className:"flex gap-1",children:[n.jsx("input",{type:"number",value:m,onChange:_=>f(_.target.value),placeholder:"px",className:"w-12 text-sm border border-gray-300 rounded px-1",onMouseDown:_=>_.stopPropagation()}),n.jsx("button",{type:"submit",className:"text-xs bg-blue-50 text-blue-600 px-1 rounded",children:"Go"})]})}),R.map(_=>n.jsx("button",{onMouseDown:W=>{W.preventDefault(),y(_)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 hover:text-blue-600",children:_},_))]})]}),n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:()=>o(!a),onBlur:()=>setTimeout(()=>o(!1),200),className:r(a),title:"Text Color",children:n.jsx(wn,{size:18})}),a&&n.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 p-2 w-[180px] flex flex-wrap gap-1",children:E.map(_=>n.jsx("button",{onMouseDown:W=>{W.preventDefault(),T(_)},className:"w-5 h-5 rounded border border-gray-300 hover:scale-110 transition-transform",style:{backgroundColor:_},title:_},_))})]})]})},Fn=({getButtonClass:r})=>{const[e,a]=x.useState(!1),[o,l]=x.useState(2),[s,i]=x.useState(2),u=m=>{m.preventDefault();let f='<table style="border-collapse: collapse; width: 100%; border: 1px solid #ccc;">';f+="<tbody>";for(let E=0;E<o;E++){f+="<tr>";for(let b=0;b<s;b++)f+='<td style="border: 1px solid #ccc; padding: 8px; min-width: 50px;">&nbsp;</td>';f+="</tr>"}f+="</tbody></table><p>&nbsp;</p>",document.execCommand("insertHTML",!1,f),a(!1)};return n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:()=>a(!e),className:r(e),title:"Insert Table",children:n.jsx(Sn,{size:18})}),e&&n.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 p-4 w-64",children:[n.jsxs("div",{className:"flex justify-between items-center mb-3",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Insert Table"}),n.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(He,{size:16})})]}),n.jsxs("form",{onSubmit:u,children:[n.jsxs("div",{className:"flex gap-4 mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Rows"}),n.jsx("input",{type:"number",min:"1",max:"10",value:o,onChange:m=>l(parseInt(m.target.value)||1),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 outline-none"})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Columns"}),n.jsx("input",{type:"number",min:"1",max:"10",value:s,onChange:m=>i(parseInt(m.target.value)||1),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 outline-none"})]})]}),n.jsx("button",{type:"submit",className:"w-full py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"Insert"})]})]})]})},Wn=({config:r,activeFormats:e,currentTextFormat:a,updateActiveFormats:o,applyTextFormat:l,editorRef:s,undo:i,redo:u,canUndo:m,canRedo:f})=>{const[E,b]=x.useState(!1),R=y=>`p-2 rounded transition-colors ${y?"bg-blue-100 text-blue-600 hover:bg-blue-200":"text-gray-600 hover:bg-gray-100"}`,T=()=>n.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),I=[{value:"p",label:"Normal text",tag:"p"},{value:"h1",label:"Title",tag:"h1"},{value:"h2",label:"Subtitle",tag:"h2"},{value:"h3",label:"Heading 1",tag:"h3"},{value:"h4",label:"Heading 2",tag:"h4"},{value:"h5",label:"Heading 3",tag:"h5"},{value:"h6",label:"Heading 4",tag:"h6"}];return n.jsx("div",{className:"sticky top-0 z-50 w-full bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-center border",children:n.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-1 max-w-7xl mx-auto w-full",children:[n.jsx(zn,{getButtonClass:R,onUndo:i,onRedo:u,canUndo:m,canRedo:f}),n.jsx(T,{}),r.showTextFormat&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>b(!E),onBlur:()=>setTimeout(()=>b(!1),200),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[130px] justify-between transition-colors",children:[n.jsx("span",{className:"font-medium truncate max-w-[100px]",children:I.find(y=>y.value===a)?.label||"Normal text"}),n.jsx(Pe,{size:14,className:"text-gray-500"})]}),E&&n.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 min-w-[160px] max-h-[300px] overflow-y-auto w-full",children:I.map(y=>n.jsx("button",{onMouseDown:G=>{G.preventDefault(),l(y.tag)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-50 ${a===y.value?"bg-blue-50 text-blue-600 font-medium":"text-gray-700"}`,children:n.jsx("span",{className:y.tag==="p"?"":y.tag==="h1"?"text-2xl font-bold":y.tag==="h2"?"text-xl font-bold":y.tag==="h3"?"text-lg font-bold":"font-bold",children:y.label})},y.value))})]}),n.jsx(T,{})]}),n.jsx(Un,{getButtonClass:R,updateActiveFormats:o}),n.jsx(T,{}),r.showInlineFormat&&n.jsxs(n.Fragment,{children:[n.jsx(At,{editorRef:s,activeFormats:{bold:e.bold,italic:e.italic,underline:e.underline,strikethrough:e.strikethrough},updateActiveFormats:o,getButtonClass:R}),n.jsx(T,{})]}),r.showAlignment&&n.jsxs(n.Fragment,{children:[n.jsx(vt,{activeFormats:{alignLeft:e.alignLeft,alignCenter:e.alignCenter,alignRight:e.alignRight,alignJustify:e.alignJustify},updateActiveFormats:o,getButtonClass:R}),n.jsx(T,{})]}),r.showList&&n.jsxs(n.Fragment,{children:[n.jsx(Rt,{editorRef:s,activeFormats:{bulletList:e.bulletList,numberedList:e.numberedList},updateActiveFormats:o,getButtonClass:R}),n.jsx(T,{})]}),r.showInsert&&n.jsxs(n.Fragment,{children:[n.jsx(Hn,{}),n.jsx(Fn,{getButtonClass:R})]})]})})};/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Ct,setPrototypeOf:kt,isFrozen:Gn,getPrototypeOf:Yn,getOwnPropertyDescriptor:Bn}=Object;let{freeze:V,seal:ne,create:tt}=Object,{apply:nt,construct:ot}=typeof Reflect<"u"&&Reflect;V||(V=function(e){return e}),ne||(ne=function(e){return e}),nt||(nt=function(e,a){for(var o=arguments.length,l=new Array(o>2?o-2:0),s=2;s<o;s++)l[s-2]=arguments[s];return e.apply(a,l)}),ot||(ot=function(e){for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return new e(...o)});const Fe=J(Array.prototype.forEach),Vn=J(Array.prototype.lastIndexOf),Lt=J(Array.prototype.pop),ke=J(Array.prototype.push),Xn=J(Array.prototype.splice),We=J(String.prototype.toLowerCase),rt=J(String.prototype.toString),st=J(String.prototype.match),Le=J(String.prototype.replace),Jn=J(String.prototype.indexOf),Zn=J(String.prototype.trim),oe=J(Object.prototype.hasOwnProperty),X=J(RegExp.prototype.test),je=Kn(TypeError);function J(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return nt(r,e,o)}}function Kn(r){return function(){for(var e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];return ot(r,a)}}function N(r,e){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:We;kt&&kt(r,null);let o=e.length;for(;o--;){let l=e[o];if(typeof l=="string"){const s=a(l);s!==l&&(Gn(e)||(e[o]=s),l=s)}r[l]=!0}return r}function Qn(r){for(let e=0;e<r.length;e++)oe(r,e)||(r[e]=null);return r}function ae(r){const e=tt(null);for(const[a,o]of Ct(r))oe(r,a)&&(Array.isArray(o)?e[a]=Qn(o):o&&typeof o=="object"&&o.constructor===Object?e[a]=ae(o):e[a]=o);return e}function Me(r,e){for(;r!==null;){const o=Bn(r,e);if(o){if(o.get)return J(o.get);if(typeof o.value=="function")return J(o.value)}r=Yn(r)}function a(){return null}return a}const jt=V(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),at=V(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lt=V(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),$n=V(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),it=V(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),qn=V(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Mt=V(["#text"]),Ot=V(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ct=V(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),It=V(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ge=V(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),eo=ne(/\{\{[\w\W]*|[\w\W]*\}\}/gm),to=ne(/<%[\w\W]*|[\w\W]*%>/gm),no=ne(/\$\{[\w\W]*/gm),oo=ne(/^data-[\-\w.\u00B7-\uFFFF]+$/),ro=ne(/^aria-[\-\w]+$/),Dt=ne(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),so=ne(/^(?:\w+script|data):/i),ao=ne(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pt=ne(/^html$/i),lo=ne(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ht=Object.freeze({__proto__:null,ARIA_ATTR:ro,ATTR_WHITESPACE:ao,CUSTOM_ELEMENT:lo,DATA_ATTR:oo,DOCTYPE_NAME:Pt,ERB_EXPR:to,IS_ALLOWED_URI:Dt,IS_SCRIPT_OR_DATA:so,MUSTACHE_EXPR:eo,TMPLIT_EXPR:no});const Oe={element:1,text:3,progressingInstruction:7,comment:8,document:9},io=function(){return typeof window>"u"?null:window},co=function(e,a){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let o=null;const l="data-tt-policy-suffix";a&&a.hasAttribute(l)&&(o=a.getAttribute(l));const s="dompurify"+(o?"#"+o:"");try{return e.createPolicy(s,{createHTML(i){return i},createScriptURL(i){return i}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},zt=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ut(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:io();const e=h=>Ut(h);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==Oe.document||!r.Element)return e.isSupported=!1,e;let{document:a}=r;const o=a,l=o.currentScript,{DocumentFragment:s,HTMLTemplateElement:i,Node:u,Element:m,NodeFilter:f,NamedNodeMap:E=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:b,DOMParser:R,trustedTypes:T}=r,I=m.prototype,y=Me(I,"cloneNode"),G=Me(I,"remove"),_=Me(I,"nextSibling"),W=Me(I,"childNodes"),$=Me(I,"parentNode");if(typeof i=="function"){const h=a.createElement("template");h.content&&h.content.ownerDocument&&(a=h.content.ownerDocument)}let C,O="";const{implementation:he,createNodeIterator:A,createDocumentFragment:Z,getElementsByTagName:U}=a,{importNode:K}=o;let S=zt();e.isSupported=typeof Ct=="function"&&typeof $=="function"&&he&&he.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:j,TMPLIT_EXPR:P,DATA_ATTR:Q,ARIA_ATTR:ee,IS_SCRIPT_OR_DATA:te,ATTR_WHITESPACE:re,CUSTOM_ELEMENT:ce}=Ht;let{IS_ALLOWED_URI:c}=Ht,g=null;const k=N({},[...jt,...at,...lt,...it,...Mt]);let w=null;const se=N({},[...Ot,...ct,...It,...Ge]);let v=Object.seal(tt(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ue=null,be=null;const M=Object.seal(tt(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let de=!0,xe=!0,Ye=!1,Ft=!0,Te=!1,Be=!0,ye=!1,ut=!1,dt=!1,_e=!1,Ve=!1,Xe=!1,Wt=!0,Gt=!1;const bo="user-content-";let ft=!0,Ie=!1,we={},le=null;const mt=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Yt=null;const Bt=N({},["audio","video","img","source","image","track"]);let pt=null;const Vt=N({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Je="http://www.w3.org/1998/Math/MathML",Ze="http://www.w3.org/2000/svg",fe="http://www.w3.org/1999/xhtml";let Ae=fe,gt=!1,ht=null;const xo=N({},[Je,Ze,fe],rt);let Ke=N({},["mi","mo","mn","ms","mtext"]),Qe=N({},["annotation-xml"]);const yo=N({},["title","style","font","a","script"]);let De=null;const Eo=["application/xhtml+xml","text/html"],No="text/html";let F=null,ve=null;const To=a.createElement("form"),Xt=function(t){return t instanceof RegExp||t instanceof Function},bt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ve&&ve===t)){if((!t||typeof t!="object")&&(t={}),t=ae(t),De=Eo.indexOf(t.PARSER_MEDIA_TYPE)===-1?No:t.PARSER_MEDIA_TYPE,F=De==="application/xhtml+xml"?rt:We,g=oe(t,"ALLOWED_TAGS")?N({},t.ALLOWED_TAGS,F):k,w=oe(t,"ALLOWED_ATTR")?N({},t.ALLOWED_ATTR,F):se,ht=oe(t,"ALLOWED_NAMESPACES")?N({},t.ALLOWED_NAMESPACES,rt):xo,pt=oe(t,"ADD_URI_SAFE_ATTR")?N(ae(Vt),t.ADD_URI_SAFE_ATTR,F):Vt,Yt=oe(t,"ADD_DATA_URI_TAGS")?N(ae(Bt),t.ADD_DATA_URI_TAGS,F):Bt,le=oe(t,"FORBID_CONTENTS")?N({},t.FORBID_CONTENTS,F):mt,ue=oe(t,"FORBID_TAGS")?N({},t.FORBID_TAGS,F):ae({}),be=oe(t,"FORBID_ATTR")?N({},t.FORBID_ATTR,F):ae({}),we=oe(t,"USE_PROFILES")?t.USE_PROFILES:!1,de=t.ALLOW_ARIA_ATTR!==!1,xe=t.ALLOW_DATA_ATTR!==!1,Ye=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ft=t.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=t.SAFE_FOR_TEMPLATES||!1,Be=t.SAFE_FOR_XML!==!1,ye=t.WHOLE_DOCUMENT||!1,_e=t.RETURN_DOM||!1,Ve=t.RETURN_DOM_FRAGMENT||!1,Xe=t.RETURN_TRUSTED_TYPE||!1,dt=t.FORCE_BODY||!1,Wt=t.SANITIZE_DOM!==!1,Gt=t.SANITIZE_NAMED_PROPS||!1,ft=t.KEEP_CONTENT!==!1,Ie=t.IN_PLACE||!1,c=t.ALLOWED_URI_REGEXP||Dt,Ae=t.NAMESPACE||fe,Ke=t.MATHML_TEXT_INTEGRATION_POINTS||Ke,Qe=t.HTML_INTEGRATION_POINTS||Qe,v=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&Xt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(v.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&Xt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(v.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(v.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(xe=!1),Ve&&(_e=!0),we&&(g=N({},Mt),w=[],we.html===!0&&(N(g,jt),N(w,Ot)),we.svg===!0&&(N(g,at),N(w,ct),N(w,Ge)),we.svgFilters===!0&&(N(g,lt),N(w,ct),N(w,Ge)),we.mathMl===!0&&(N(g,it),N(w,It),N(w,Ge))),t.ADD_TAGS&&(typeof t.ADD_TAGS=="function"?M.tagCheck=t.ADD_TAGS:(g===k&&(g=ae(g)),N(g,t.ADD_TAGS,F))),t.ADD_ATTR&&(typeof t.ADD_ATTR=="function"?M.attributeCheck=t.ADD_ATTR:(w===se&&(w=ae(w)),N(w,t.ADD_ATTR,F))),t.ADD_URI_SAFE_ATTR&&N(pt,t.ADD_URI_SAFE_ATTR,F),t.FORBID_CONTENTS&&(le===mt&&(le=ae(le)),N(le,t.FORBID_CONTENTS,F)),t.ADD_FORBID_CONTENTS&&(le===mt&&(le=ae(le)),N(le,t.ADD_FORBID_CONTENTS,F)),ft&&(g["#text"]=!0),ye&&N(g,["html","head","body"]),g.table&&(N(g,["tbody"]),delete ue.tbody),t.TRUSTED_TYPES_POLICY){if(typeof t.TRUSTED_TYPES_POLICY.createHTML!="function")throw je('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof t.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw je('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=t.TRUSTED_TYPES_POLICY,O=C.createHTML("")}else C===void 0&&(C=co(T,l)),C!==null&&typeof O=="string"&&(O=C.createHTML(""));V&&V(t),ve=t}},Jt=N({},[...at,...lt,...$n]),Zt=N({},[...it,...qn]),_o=function(t){let d=$(t);(!d||!d.tagName)&&(d={namespaceURI:Ae,tagName:"template"});const p=We(t.tagName),L=We(d.tagName);return ht[t.namespaceURI]?t.namespaceURI===Ze?d.namespaceURI===fe?p==="svg":d.namespaceURI===Je?p==="svg"&&(L==="annotation-xml"||Ke[L]):!!Jt[p]:t.namespaceURI===Je?d.namespaceURI===fe?p==="math":d.namespaceURI===Ze?p==="math"&&Qe[L]:!!Zt[p]:t.namespaceURI===fe?d.namespaceURI===Ze&&!Qe[L]||d.namespaceURI===Je&&!Ke[L]?!1:!Zt[p]&&(yo[p]||!Jt[p]):!!(De==="application/xhtml+xml"&&ht[t.namespaceURI]):!1},ie=function(t){ke(e.removed,{element:t});try{$(t).removeChild(t)}catch{G(t)}},Ee=function(t,d){try{ke(e.removed,{attribute:d.getAttributeNode(t),from:d})}catch{ke(e.removed,{attribute:null,from:d})}if(d.removeAttribute(t),t==="is")if(_e||Ve)try{ie(d)}catch{}else try{d.setAttribute(t,"")}catch{}},Kt=function(t){let d=null,p=null;if(dt)t="<remove></remove>"+t;else{const H=st(t,/^[\r\n\t ]+/);p=H&&H[0]}De==="application/xhtml+xml"&&Ae===fe&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const L=C?C.createHTML(t):t;if(Ae===fe)try{d=new R().parseFromString(L,De)}catch{}if(!d||!d.documentElement){d=he.createDocument(Ae,"template",null);try{d.documentElement.innerHTML=gt?O:L}catch{}}const B=d.body||d.documentElement;return t&&p&&B.insertBefore(a.createTextNode(p),B.childNodes[0]||null),Ae===fe?U.call(d,ye?"html":"body")[0]:ye?d.documentElement:B},Qt=function(t){return A.call(t.ownerDocument||t,t,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},xt=function(t){return t instanceof b&&(typeof t.nodeName!="string"||typeof t.textContent!="string"||typeof t.removeChild!="function"||!(t.attributes instanceof E)||typeof t.removeAttribute!="function"||typeof t.setAttribute!="function"||typeof t.namespaceURI!="string"||typeof t.insertBefore!="function"||typeof t.hasChildNodes!="function")},$t=function(t){return typeof u=="function"&&t instanceof u};function me(h,t,d){Fe(h,p=>{p.call(e,t,d,ve)})}const qt=function(t){let d=null;if(me(S.beforeSanitizeElements,t,null),xt(t))return ie(t),!0;const p=F(t.nodeName);if(me(S.uponSanitizeElement,t,{tagName:p,allowedTags:g}),Be&&t.hasChildNodes()&&!$t(t.firstElementChild)&&X(/<[/\w!]/g,t.innerHTML)&&X(/<[/\w!]/g,t.textContent)||t.nodeType===Oe.progressingInstruction||Be&&t.nodeType===Oe.comment&&X(/<[/\w]/g,t.data))return ie(t),!0;if(!(M.tagCheck instanceof Function&&M.tagCheck(p))&&(!g[p]||ue[p])){if(!ue[p]&&tn(p)&&(v.tagNameCheck instanceof RegExp&&X(v.tagNameCheck,p)||v.tagNameCheck instanceof Function&&v.tagNameCheck(p)))return!1;if(ft&&!le[p]){const L=$(t)||t.parentNode,B=W(t)||t.childNodes;if(B&&L){const H=B.length;for(let q=H-1;q>=0;--q){const pe=y(B[q],!0);pe.__removalCount=(t.__removalCount||0)+1,L.insertBefore(pe,_(t))}}}return ie(t),!0}return t instanceof m&&!_o(t)||(p==="noscript"||p==="noembed"||p==="noframes")&&X(/<\/no(script|embed|frames)/i,t.innerHTML)?(ie(t),!0):(Te&&t.nodeType===Oe.text&&(d=t.textContent,Fe([D,j,P],L=>{d=Le(d,L," ")}),t.textContent!==d&&(ke(e.removed,{element:t.cloneNode()}),t.textContent=d)),me(S.afterSanitizeElements,t,null),!1)},en=function(t,d,p){if(Wt&&(d==="id"||d==="name")&&(p in a||p in To))return!1;if(!(xe&&!be[d]&&X(Q,d))){if(!(de&&X(ee,d))){if(!(M.attributeCheck instanceof Function&&M.attributeCheck(d,t))){if(!w[d]||be[d]){if(!(tn(t)&&(v.tagNameCheck instanceof RegExp&&X(v.tagNameCheck,t)||v.tagNameCheck instanceof Function&&v.tagNameCheck(t))&&(v.attributeNameCheck instanceof RegExp&&X(v.attributeNameCheck,d)||v.attributeNameCheck instanceof Function&&v.attributeNameCheck(d,t))||d==="is"&&v.allowCustomizedBuiltInElements&&(v.tagNameCheck instanceof RegExp&&X(v.tagNameCheck,p)||v.tagNameCheck instanceof Function&&v.tagNameCheck(p))))return!1}else if(!pt[d]){if(!X(c,Le(p,re,""))){if(!((d==="src"||d==="xlink:href"||d==="href")&&t!=="script"&&Jn(p,"data:")===0&&Yt[t])){if(!(Ye&&!X(te,Le(p,re,"")))){if(p)return!1}}}}}}}return!0},tn=function(t){return t!=="annotation-xml"&&st(t,ce)},nn=function(t){me(S.beforeSanitizeAttributes,t,null);const{attributes:d}=t;if(!d||xt(t))return;const p={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let L=d.length;for(;L--;){const B=d[L],{name:H,namespaceURI:q,value:pe}=B,Se=F(H),yt=pe;let Y=H==="value"?yt:Zn(yt);if(p.attrName=Se,p.attrValue=Y,p.keepAttr=!0,p.forceKeepAttr=void 0,me(S.uponSanitizeAttribute,t,p),Y=p.attrValue,Gt&&(Se==="id"||Se==="name")&&(Ee(H,t),Y=bo+Y),Be&&X(/((--!?|])>)|<\/(style|title|textarea)/i,Y)){Ee(H,t);continue}if(Se==="attributename"&&st(Y,"href")){Ee(H,t);continue}if(p.forceKeepAttr)continue;if(!p.keepAttr){Ee(H,t);continue}if(!Ft&&X(/\/>/i,Y)){Ee(H,t);continue}Te&&Fe([D,j,P],rn=>{Y=Le(Y,rn," ")});const on=F(t.nodeName);if(!en(on,Se,Y)){Ee(H,t);continue}if(C&&typeof T=="object"&&typeof T.getAttributeType=="function"&&!q)switch(T.getAttributeType(on,Se)){case"TrustedHTML":{Y=C.createHTML(Y);break}case"TrustedScriptURL":{Y=C.createScriptURL(Y);break}}if(Y!==yt)try{q?t.setAttributeNS(q,H,Y):t.setAttribute(H,Y),xt(t)?ie(t):Lt(e.removed)}catch{Ee(H,t)}}me(S.afterSanitizeAttributes,t,null)},wo=function h(t){let d=null;const p=Qt(t);for(me(S.beforeSanitizeShadowDOM,t,null);d=p.nextNode();)me(S.uponSanitizeShadowNode,d,null),qt(d),nn(d),d.content instanceof s&&h(d.content);me(S.afterSanitizeShadowDOM,t,null)};return e.sanitize=function(h){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=null,p=null,L=null,B=null;if(gt=!h,gt&&(h="<!-->"),typeof h!="string"&&!$t(h))if(typeof h.toString=="function"){if(h=h.toString(),typeof h!="string")throw je("dirty is not a string, aborting")}else throw je("toString is not a function");if(!e.isSupported)return h;if(ut||bt(t),e.removed=[],typeof h=="string"&&(Ie=!1),Ie){if(h.nodeName){const pe=F(h.nodeName);if(!g[pe]||ue[pe])throw je("root node is forbidden and cannot be sanitized in-place")}}else if(h instanceof u)d=Kt("<!---->"),p=d.ownerDocument.importNode(h,!0),p.nodeType===Oe.element&&p.nodeName==="BODY"||p.nodeName==="HTML"?d=p:d.appendChild(p);else{if(!_e&&!Te&&!ye&&h.indexOf("<")===-1)return C&&Xe?C.createHTML(h):h;if(d=Kt(h),!d)return _e?null:Xe?O:""}d&&dt&&ie(d.firstChild);const H=Qt(Ie?h:d);for(;L=H.nextNode();)qt(L),nn(L),L.content instanceof s&&wo(L.content);if(Ie)return h;if(_e){if(Ve)for(B=Z.call(d.ownerDocument);d.firstChild;)B.appendChild(d.firstChild);else B=d;return(w.shadowroot||w.shadowrootmode)&&(B=K.call(o,B,!0)),B}let q=ye?d.outerHTML:d.innerHTML;return ye&&g["!doctype"]&&d.ownerDocument&&d.ownerDocument.doctype&&d.ownerDocument.doctype.name&&X(Pt,d.ownerDocument.doctype.name)&&(q="<!DOCTYPE "+d.ownerDocument.doctype.name+`>
`+q),Te&&Fe([D,j,P],pe=>{q=Le(q,pe," ")}),C&&Xe?C.createHTML(q):q},e.setConfig=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bt(h),ut=!0},e.clearConfig=function(){ve=null,ut=!1},e.isValidAttribute=function(h,t,d){ve||bt({});const p=F(h),L=F(t);return en(p,L,d)},e.addHook=function(h,t){typeof t=="function"&&ke(S[h],t)},e.removeHook=function(h,t){if(t!==void 0){const d=Vn(S[h],t);return d===-1?void 0:Xn(S[h],d,1)[0]}return Lt(S[h])},e.removeHooks=function(h){S[h]=[]},e.removeAllHooks=function(){S=zt()},e}var uo=Ut();const fo=r=>{const[e,a]=x.useState([{html:r}]),[o,l]=x.useState(0),s=x.useRef(null),i=x.useCallback((b,R=!1)=>{if(s.current&&clearTimeout(s.current),R){a(T=>T[o].html===b?T:[...T.slice(0,o+1),{html:b}]),l(T=>T+1);return}s.current=setTimeout(()=>{a(T=>T[o].html===b?T:[...T.slice(0,o+1),{html:b}]),l(T=>T+1)},500)},[o]),u=x.useCallback(()=>{if(o>0){const b=o-1;return l(b),e[b].html}return null},[o,e]),m=x.useCallback(()=>{if(o<e.length-1){const b=o+1;return l(b),e[b].html}return null},[o,e]),f=o>0,E=o<e.length-1;return{history:e,pointer:o,pushState:i,undo:u,redo:m,canUndo:f,canRedo:E}},mo=()=>{const r=[];for(let e=0;e<=80;e++){const a=e*10,o=e%10===0?12:e%5===0?8:4;r.push(n.jsx("line",{x1:a,y1:20-o,x2:a,y2:20,stroke:"#ccc",strokeWidth:"1"},e)),e%10===0&&r.push(n.jsx("text",{x:a+2,y:10,fontSize:"8",fill:"#999",children:e},`text-${e}`))}return n.jsxs("div",{className:"h-6 w-full bg-gray-50 border-b border-gray-300 relative overflow-hidden select-none",children:[n.jsx("svg",{width:"100%",height:"100%",className:"absolute left-8",children:r}),n.jsx("div",{className:"absolute top-0 left-0 w-8 h-full bg-gray-200 border-r border-gray-300 opacity-50"}),n.jsx("div",{className:"absolute top-0 right-0 w-8 h-full bg-gray-200 border-l border-gray-300 opacity-50"})]})},po=()=>{const r=[];for(let e=0;e<=100;e++){const a=e*10,o=e%10===0?12:e%5===0?8:4;r.push(n.jsx("line",{x1:20-o,y1:a,x2:20,y2:a,stroke:"#ccc",strokeWidth:"1"},e)),e%10===0&&e!==0&&r.push(n.jsx("text",{x:2,y:a+8,fontSize:"8",fill:"#999",className:"rotate-[-90deg] origin-center",children:e},`text-${e}`))}return n.jsxs("div",{className:"w-6 h-full bg-gray-50 border-r border-gray-300 relative overflow-hidden select-none flex-shrink-0",children:[n.jsx("svg",{width:"100%",height:"2000px",className:"absolute top-8",children:r}),n.jsx("div",{className:"absolute top-0 left-0 w-full h-8 bg-gray-200 border-b border-gray-300 opacity-50"})]})},go=({content:r="",onChange:e,onBlur:a,onFocus:o,config:l={showTextFormat:!0,showInlineFormat:!0,showAlignment:!0,showList:!0,showInsert:!0}})=>{const s=x.useRef(null),[i,u]=x.useState({bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,bulletList:!1,numberedList:!1}),[m,f]=x.useState("p"),{pushState:E,undo:b,redo:R,canUndo:T,canRedo:I}=fo(r),y=()=>{const A=b();A!==null&&s.current&&(s.current.innerHTML=A,e&&e(A),O())},G=()=>{const A=R();A!==null&&s.current&&(s.current.innerHTML=A,e&&e(A),O())},_=A=>{const Z=window.getSelection();if(!Z||Z.rangeCount===0)return;const U=Z.getRangeAt(0);let K=U.commonAncestorContainer;K.nodeType===Node.TEXT_NODE&&(K=K.parentNode);let S=null,D=K;for(;D&&D!==s.current;){if(D.nodeType===Node.ELEMENT_NODE){const j=D,P=j.tagName.toLowerCase();if(["p","h1","h2","h3","h4","h5","h6","div"].includes(P)){S=j;break}}D=D.parentNode}if(S&&S!==s.current){const j=document.createElement(A);j.innerHTML=S.innerHTML,S.style.textAlign&&(j.style.textAlign=S.style.textAlign),S.parentNode?.replaceChild(j,S),f(A);const P=document.createRange();P.selectNodeContents(j),Z.removeAllRanges(),Z.addRange(P)}else{const j=document.createElement(A);if(U.toString())try{U.surroundContents(j)}catch{const Q=U.extractContents();j.appendChild(Q),U.insertNode(j)}else{j.innerHTML="<br>",U.insertNode(j);const P=document.createRange();P.setStart(j,0),P.collapse(!0),Z.removeAllRanges(),Z.addRange(P)}f(A)}s.current&&E(s.current.innerHTML,!0),setTimeout(()=>O(),10)},W=()=>{if(s.current&&e){const A=s.current.innerHTML;e(A),E(A)}},$=()=>{if(a&&s.current){const A=s.current.innerHTML;a(A)}},C=()=>{o&&o()};x.useEffect(()=>{if(s.current&&r!==void 0){const A=uo.sanitize(r);s.current.innerHTML!==A&&(s.current.innerHTML=A)}},[r]);const O=()=>{const A=window.getSelection();if(!A||A.rangeCount===0)return;let U=A.getRangeAt(0).commonAncestorContainer;U.nodeType===Node.TEXT_NODE&&(U=U.parentNode);let K=U,S="p";for(;K&&K!==s.current;){if(["H1","H2","H3","H4","H5","H6","P"].includes(K.tagName)){S=K.tagName.toLowerCase();break}K=K.parentElement}f(S);let D=U,j=!1,P=!1;for(;D&&D!==s.current;){if(D.tagName==="UL"){j=!0;break}else if(D.tagName==="OL"){P=!0;break}D=D.parentElement}const Q=ce=>{let c=U;for(;c&&c!==s.current;){if(c.nodeType===Node.ELEMENT_NODE&&c.tagName.toLowerCase()===ce.toLowerCase())return!0;c=c.parentNode}return!1};let ee=U;for(;ee&&ee!==s.current;){if(ee.nodeType===Node.ELEMENT_NODE){const ce=ee.tagName.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p"].includes(ce)){f(ce);break}}ee=ee.parentNode}(ee===s.current||!ee)&&f("p");let te=U;for(;te&&te!==s.current&&te.nodeType!==Node.ELEMENT_NODE;)te=te.parentNode;const re=te&&te.nodeType===Node.ELEMENT_NODE?te.style.textAlign:"";u({bold:Q("strong")||Q("b"),italic:Q("em")||Q("i"),underline:Q("u"),strikethrough:Q("s")||Q("strike")||Q("del"),alignLeft:re===""||re==="left",alignCenter:re==="center",alignRight:re==="right",alignJustify:re==="justify",bulletList:j,numberedList:P})},he=()=>{const A=window.getSelection();if(A&&A.rangeCount>0){const Z=A.getRangeAt(0);s.current?.contains(Z.commonAncestorContainer)&&O()}};return x.useEffect(()=>(document.addEventListener("selectionchange",he),()=>{document.removeEventListener("selectionchange",he)}),[]),n.jsxs("div",{className:"teddy-editor w-full h-screen bg-gray-100 flex flex-col overflow-hidden",children:[n.jsx(Wn,{config:l,activeFormats:i,currentTextFormat:m,updateActiveFormats:O,applyTextFormat:_,editorRef:s,undo:y,redo:G,canUndo:T,canRedo:I}),n.jsx("div",{className:"flex-1 overflow-auto flex justify-center p-4 relative",children:n.jsxs("div",{className:"flex flex-col gap-1 w-full max-w-4xl",children:[n.jsx("div",{className:"pl-6 select-none bg-gray-100 sticky top-0 z-10 pt-2",children:n.jsx(mo,{})}),n.jsxs("div",{className:"flex",children:[n.jsx("div",{className:"pr-1 select-none pt-8 hidden sm:block h-full",children:n.jsx(po,{})}),n.jsx("div",{ref:s,contentEditable:!0,className:"document-page outline-none focus:ring-0 prose prose-headings:mt-4 prose-headings:mb-2 w-full bg-white shadow-sm p-8 min-h-[1000px]",style:{whiteSpace:"pre-wrap"},onMouseUp:O,onKeyUp:O,onInput:W,onBlur:$,onFocus:C})]})]})}),n.jsx(Ln,{editorRef:s,activeFormats:i,currentTextFormat:m,updateActiveFormats:O,applyTextFormat:_})]})};function ho(){return n.jsx("div",{children:n.jsx(go,{content:"<p>Initial content</p>",onChange:r=>console.log("Content changed:",r),onBlur:r=>console.log("Editor lost focus",r),onFocus:()=>console.log("Editor gained focus")})})}return ho});
