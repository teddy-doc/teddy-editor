(function(b,pe){typeof exports=="object"&&typeof module<"u"?module.exports=pe(require("react")):typeof define=="function"&&define.amd?define(["react"],pe):(b=typeof globalThis<"u"?globalThis:b||self,b.TeddyEditor=pe(b.React))})(this,function(b){"use strict";var pe={exports:{}},Re={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Et;function sn(){if(Et)return Re;Et=1;var o=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(r,l,s){var i=null;if(s!==void 0&&(i=""+s),l.key!==void 0&&(i=""+l.key),"key"in l){s={};for(var u in l)u!=="key"&&(s[u]=l[u])}else s=l;return l=s.ref,{$$typeof:o,type:r,key:i,ref:l!==void 0?l:null,props:s}}return Re.Fragment=n,Re.jsx=a,Re.jsxs=a,Re}var Ce={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nt;function an(){return Nt||(Nt=1,process.env.NODE_ENV!=="production"&&function(){function o(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===F?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case N:return"Fragment";case S:return"Profiler";case j:return"StrictMode";case $:return"Suspense";case ge:return"SuspenseList";case A:return"Activity"}if(typeof c=="object")switch(typeof c.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),c.$$typeof){case C:return"Portal";case K:return(c.displayName||"Context")+".Provider";case U:return(c._context.displayName||"Context")+".Consumer";case L:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case oe:return h=c.displayName||null,h!==null?h:o(c.type)||"Memo";case he:h=c._payload,c=c._init;try{return o(c(h))}catch{}}return null}function n(c){return""+c}function a(c){try{n(c);var h=!1}catch{h=!0}if(h){h=console;var R=h.error,v=typeof Symbol=="function"&&Symbol.toStringTag&&c[Symbol.toStringTag]||c.constructor.name||"Object";return R.call(h,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",v),n(c)}}function r(c){if(c===N)return"<>";if(typeof c=="object"&&c!==null&&c.$$typeof===he)return"<...>";try{var h=o(c);return h?"<"+h+">":"<...>"}catch{return"<...>"}}function l(){var c=w.A;return c===null?null:c.getOwner()}function s(){return Error("react-stack-top-frame")}function i(c){if(W.call(c,"key")){var h=Object.getOwnPropertyDescriptor(c,"key").get;if(h&&h.isReactWarning)return!1}return c.key!==void 0}function u(c,h){function R(){D||(D=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",h))}R.isReactWarning=!0,Object.defineProperty(c,"key",{get:R,configurable:!0})}function m(){var c=o(this.type);return Y[c]||(Y[c]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),c=this.props.ref,c!==void 0?c:null}function f(c,h,R,v,se,k,ce,xe){return R=k.ref,c={$$typeof:E,type:c,key:h,props:k,_owner:se},(R!==void 0?R:null)!==null?Object.defineProperty(c,"ref",{enumerable:!1,get:m}):Object.defineProperty(c,"ref",{enumerable:!1,value:null}),c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(c,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(c,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:ce}),Object.defineProperty(c,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:xe}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}function T(c,h,R,v,se,k,ce,xe){var O=h.children;if(O!==void 0)if(v)if(G(O)){for(v=0;v<O.length;v++)p(O[v]);Object.freeze&&Object.freeze(O)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else p(O);if(W.call(h,"key")){O=o(c);var ue=Object.keys(h).filter(function(Ye){return Ye!=="key"});v=0<ue.length?"{key: someKey, "+ue.join(": ..., ")+": ...}":"{key: someKey}",te[O+v]||(ue=0<ue.length?"{"+ue.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,v,O,ue,O),te[O+v]=!0)}if(O=null,R!==void 0&&(a(R),O=""+R),i(h)&&(a(h.key),O=""+h.key),"key"in h){R={};for(var be in h)be!=="key"&&(R[be]=h[be])}else R=h;return O&&u(R,typeof c=="function"?c.displayName||c.name||"Unknown":c),f(c,O,k,se,l(),R,ce,xe)}function p(c){typeof c=="object"&&c!==null&&c.$$typeof===E&&c._store&&(c._store.validated=1)}var g=b,E=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),K=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),ge=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),F=Symbol.for("react.client.reference"),w=g.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=Object.prototype.hasOwnProperty,G=Array.isArray,I=console.createTask?console.createTask:function(){return null};g={"react-stack-bottom-frame":function(c){return c()}};var D,Y={},Q=g["react-stack-bottom-frame"].bind(g,s)(),q=I(r(s)),te={};Ce.Fragment=N,Ce.jsx=function(c,h,R,v,se){var k=1e4>w.recentlyCreatedOwnerStacks++;return T(c,h,R,!1,v,se,k?Error("react-stack-top-frame"):Q,k?I(r(c)):q)},Ce.jsxs=function(c,h,R,v,se){var k=1e4>w.recentlyCreatedOwnerStacks++;return T(c,h,R,!0,v,se,k?Error("react-stack-top-frame"):Q,k?I(r(c)):q)}}()),Ce}var Tt;function ln(){return Tt||(Tt=1,process.env.NODE_ENV==="production"?pe.exports=sn():pe.exports=an()),pe.exports}var e=ln();/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),un=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,a,r)=>r?r.toUpperCase():a.toLowerCase()),wt=o=>{const n=un(o);return n.charAt(0).toUpperCase()+n.slice(1)},_t=(...o)=>o.filter((n,a,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===a).join(" ").trim(),dn=o=>{for(const n in o)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=b.forwardRef(({color:o="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:l="",children:s,iconNode:i,...u},m)=>b.createElement("svg",{ref:m,...mn,width:n,height:n,stroke:o,strokeWidth:r?Number(a)*24/Number(n):a,className:_t("lucide",l),...!s&&!dn(u)&&{"aria-hidden":"true"},...u},[...i.map(([f,T])=>b.createElement(f,T)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=(o,n)=>{const a=b.forwardRef(({className:r,...l},s)=>b.createElement(fn,{ref:s,iconNode:n,className:_t(`lucide-${cn(wt(o))}`,`lucide-${o}`,r),...l}));return a.displayName=wt(o),a};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=H("align-center",[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=H("align-justify",[["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 18h18",key:"1h113x"}],["path",{d:"M3 6h18",key:"d0wm0j"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=H("align-left",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=H("align-right",[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=H("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=H("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=H("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=H("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=H("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=H("list-ordered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=H("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=H("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=H("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=H("strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=H("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=H("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=H("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=H("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=H("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ze=(o,n,a)=>{const r=window.getSelection();if(!r||r.rangeCount===0||!n.current)return;const l=r.getRangeAt(0);if(l.toString())try{const s=()=>{let f=l.commonAncestorContainer;for(;f&&f!==n.current;){if(f.nodeType===Node.ELEMENT_NODE){const T=f;if(T.tagName.toLowerCase()===o.toLowerCase())return{isFormatted:!0,formatElement:T}}f=f.parentNode}return{isFormatted:!1,formatElement:null}},{isFormatted:i,formatElement:u}=s();let m=null;if(i&&u){const f=u.parentNode,T=document.createTextNode(u.textContent||"");f?.replaceChild(T,u),f?.normalize();const p=document.createRange();p.selectNodeContents(T),r.removeAllRanges(),r.addRange(p)}else{m=document.createElement(o);try{l.surroundContents(m);const f=document.createRange();f.selectNodeContents(m),r.removeAllRanges(),r.addRange(f)}catch{const T=l.extractContents();m.appendChild(T),l.insertNode(m);const p=document.createRange();p.selectNodeContents(m),r.removeAllRanges(),r.addRange(p)}}a()}catch(s){console.warn("Error applying format:",s),a()}},At=({editorRef:o,activeFormats:n,updateActiveFormats:a,getButtonClass:r})=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>ze("strong",o,a),className:r(n.bold),title:"Bold",children:e.jsx(bn,{size:18})}),e.jsx("button",{onClick:()=>ze("em",o,a),className:r(n.italic),title:"Italic",children:e.jsx(En,{size:18})}),e.jsx("button",{onClick:()=>ze("u",o,a),className:r(n.underline),title:"Underline",children:e.jsx(Rn,{size:18})}),e.jsx("button",{onClick:()=>ze("s",o,a),className:r(n.strikethrough),title:"Strikethrough",children:e.jsx(vn,{size:18})})]}),Ue=(o,n)=>{const a=window.getSelection();if(!a||a.rangeCount===0)return;let l=a.getRangeAt(0).commonAncestorContainer;for(;l&&l.nodeType!==Node.ELEMENT_NODE;)l=l.parentNode;if(l&&l.nodeType===Node.ELEMENT_NODE){const s=l;s.style.textAlign=o==="left"?"":o,n()}},vt=({activeFormats:o,updateActiveFormats:n,getButtonClass:a})=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>Ue("left",n),className:a(o.alignLeft),title:"Align Left",children:e.jsx(hn,{size:18})}),e.jsx("button",{onClick:()=>Ue("center",n),className:a(o.alignCenter),title:"Align Center",children:e.jsx(pn,{size:18})}),e.jsx("button",{onClick:()=>Ue("right",n),className:a(o.alignRight),title:"Align Right",children:e.jsx(xn,{size:18})}),e.jsx("button",{onClick:()=>Ue("justify",n),className:a(o.alignJustify),title:"Justify",children:e.jsx(gn,{size:18})})]}),St=(o,n,a)=>{const r=window.getSelection();if(!r||r.rangeCount===0||!n.current)return;const l=r.getRangeAt(0);let s=l.commonAncestorContainer;s.nodeType===Node.TEXT_NODE&&(s=s.parentNode);let i=s;for(;i&&i!==n.current&&!["P","H1","H2","H3","H4","H5","H6","LI","UL","OL"].includes(i.tagName);)i=i.parentElement;if(!i||i===n.current){const u=document.createElement(o),m=document.createElement("li");m.textContent=r.toString()||"List item",u.appendChild(m),l.deleteContents(),l.insertNode(u);const f=document.createRange();f.setStart(m,0),f.setEnd(m,m.childNodes.length),r.removeAllRanges(),r.addRange(f)}else if(i.tagName==="LI"){const u=i.parentElement;if(u.tagName.toLowerCase()===o){const m=document.createElement("p");m.innerHTML=i.innerHTML,u.parentNode?.replaceChild(m,u)}else{const m=document.createElement(o);m.innerHTML=u.innerHTML,u.parentNode?.replaceChild(m,u)}}else{const u=document.createElement(o),m=document.createElement("li");m.innerHTML=i.innerHTML,u.appendChild(m),i.parentNode?.replaceChild(u,i)}a()},Rt=({editorRef:o,activeFormats:n,updateActiveFormats:a,getButtonClass:r})=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{o?.current&&St("ul",o,a)},className:r(n.bulletList),title:"Bullet List",children:e.jsx(wn,{size:18})}),e.jsx("button",{onClick:()=>{o?.current&&St("ol",o,a)},className:r(n.numberedList),title:"Numbered List",children:e.jsx(Tn,{size:18})})]}),Ln=({editorRef:o,activeFormats:n,currentTextFormat:a,updateActiveFormats:r,applyTextFormat:l})=>{const[s,i]=b.useState({top:0,left:0}),[u,m]=b.useState(!1),[f,T]=b.useState(!1),p=b.useRef(null),g=[{value:"p",label:"Paragraph",tag:"p"},{value:"h1",label:"Heading 1",tag:"h1"},{value:"h2",label:"Heading 2",tag:"h2"},{value:"h3",label:"Heading 3",tag:"h3"},{value:"h4",label:"Heading 4",tag:"h4"},{value:"h5",label:"Heading 5",tag:"h5"},{value:"h6",label:"Heading 6",tag:"h6"}];b.useEffect(()=>{const N=()=>{const j=window.getSelection();if(!j||j.rangeCount===0||j.isCollapsed||!o.current||!o.current.contains(j.anchorNode)){m(!1),T(!1);return}const U=j.getRangeAt(0).getBoundingClientRect(),K=p.current?.offsetHeight||50,L=U.top-K-45,$=U.left+U.width/2;i({top:L,left:$}),m(!0)};return document.addEventListener("selectionchange",N),window.addEventListener("scroll",N,!0),window.addEventListener("resize",N),()=>{document.removeEventListener("selectionchange",N),window.removeEventListener("scroll",N,!0),window.removeEventListener("resize",N)}},[o]);const E=N=>`p-1.5 rounded transition-colors ${N?"bg-blue-100 text-blue-600 hover:bg-blue-200":"text-gray-600 hover:bg-gray-100"}`,C=N=>{l(N),T(!1)};return u?e.jsxs("div",{ref:p,className:"fixed z-40 flex items-center gap-1 p-1 bg-white rounded-lg shadow-lg border border-gray-200 animate-in fade-in zoom-in-95 duration-200",style:{top:`${s.top}px`,left:`${s.left}px`,transform:"translateX(-50%)"},onMouseDown:N=>{N.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>T(!f),className:"flex items-center gap-1 px-2 py-1.5 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[100px] justify-between",children:[e.jsx("span",{className:"truncate max-w-[80px]",children:g.find(N=>N.value===a)?.label||"Paragraph"}),e.jsx(Pe,{size:12})]}),f&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-xl overflow-hidden min-w-[140px] max-h-[300px] overflow-y-auto",children:g.map(N=>e.jsx("button",{onClick:()=>C(N.tag),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${a===N.value?"bg-blue-50 text-blue-600":"text-gray-700"}`,children:N.label},N.value))})]}),e.jsx("div",{className:"w-px h-5 bg-gray-200 mx-1"}),e.jsx(At,{editorRef:o,activeFormats:n,updateActiveFormats:r,getButtonClass:E}),e.jsx("div",{className:"w-px h-5 bg-gray-200 mx-1"}),e.jsx(Rt,{editorRef:o,activeFormats:{bulletList:n.bulletList,numberedList:n.numberedList},updateActiveFormats:r,getButtonClass:E}),e.jsx("div",{className:"w-px h-5 bg-gray-200 mx-1"}),e.jsx(vt,{activeFormats:{alignLeft:n.alignLeft,alignCenter:n.alignCenter,alignRight:n.alignRight,alignJustify:n.alignJustify},updateActiveFormats:r,getButtonClass:E})]}):null};let Ne=null;const Qe=()=>{const o=window.getSelection();o&&o.rangeCount>0&&(Ne=o.getRangeAt(0).cloneRange())},qe=()=>{if(Ne){const o=window.getSelection();o?.removeAllRanges(),o?.addRange(Ne)}},et=()=>{const o=window.getSelection();if(!o||o.rangeCount===0)return null;let a=o.getRangeAt(0).commonAncestorContainer;a.nodeType===Node.TEXT_NODE&&(a=a.parentNode);let r=a;for(;r&&r!==document.body;){if(r.nodeType===Node.ELEMENT_NODE){const l=r,s=l.tagName.toLowerCase();if(s==="a")return{type:"link",url:l.getAttribute("href")||"",text:l.textContent||""};if(s==="img")return{type:"image",src:l.getAttribute("src")||"",alt:l.getAttribute("alt")||""};if(s==="iframe")return{type:"video",src:l.getAttribute("src")||""}}r=r.parentNode}return null},jn=(o,n)=>{qe();const a=window.getSelection();if(!a||a.rangeCount===0){const i=document.querySelector('[contenteditable="true"]');if(i){const u=document.createElement("a");u.href=o,u.textContent=n||o,u.target="_blank",u.rel="noopener noreferrer",u.className="text-blue-600 underline hover:text-blue-800",i.appendChild(u);const m=document.createTextNode(" ");i.appendChild(m);const f=document.createRange();f.setStartAfter(m),f.collapse(!0),a&&(a.removeAllRanges(),a.addRange(f))}return}const r=a.getRangeAt(0);let l=null,s=r.commonAncestorContainer;for(;s&&s!==document.body;){if(s.nodeType===Node.ELEMENT_NODE&&s.tagName.toLowerCase()==="a"){l=s;break}s=s.parentNode}if(l)l.setAttribute("href",o),l.textContent=n||o;else{const i=document.createElement("a");i.href=o,i.textContent=n||o,i.target="_blank",i.rel="noopener noreferrer",i.className="text-blue-600 underline hover:text-blue-800",r.deleteContents(),r.insertNode(i);const u=document.createRange();u.setStartAfter(i),u.collapse(!0),a.removeAllRanges(),a.addRange(u)}Ne=null},Mn=(o,n="Inserted image")=>{qe();const a=window.getSelection();if(!a||a.rangeCount===0){const i=document.querySelector('[contenteditable="true"]');if(i){const u=document.createElement("img");u.src=o,u.alt=n,u.className="max-w-full h-auto rounded shadow-sm",i.appendChild(u);const m=document.createElement("br");i.appendChild(m);const f=document.createRange();f.setStartAfter(m),f.collapse(!0),a&&(a.removeAllRanges(),a.addRange(f))}return}const r=a.getRangeAt(0);let l=null,s=r.commonAncestorContainer;for(;s&&s!==document.body;){if(s.nodeType===Node.ELEMENT_NODE&&s.tagName.toLowerCase()==="img"){l=s;break}s=s.parentNode}if(l)l.setAttribute("src",o),l.setAttribute("alt",n);else{const i=document.createElement("img");i.src=o,i.alt=n,i.className="max-w-full h-auto rounded shadow-sm",r.deleteContents(),r.insertNode(i);const u=document.createRange();u.setStartAfter(i),u.collapse(!0),a.removeAllRanges(),a.addRange(u)}Ne=null},On=o=>{qe();const n=window.getSelection();if(!n||n.rangeCount===0){const s=document.querySelector('[contenteditable="true"]');if(s){const i=document.createElement("iframe");i.src=o,i.width="560",i.height="315",i.className="max-w-full rounded shadow-sm",i.setAttribute("frameborder","0"),i.setAttribute("allowfullscreen","true"),i.setAttribute("sandbox","allow-scripts allow-same-origin allow-presentation"),s.appendChild(i);const u=document.createElement("br");s.appendChild(u);const m=document.createRange();m.setStartAfter(u),m.collapse(!0),n&&(n.removeAllRanges(),n.addRange(m))}return}const a=n.getRangeAt(0);let r=null,l=a.commonAncestorContainer;for(;l&&l!==document.body;){if(l.nodeType===Node.ELEMENT_NODE&&l.tagName.toLowerCase()==="iframe"){r=l;break}l=l.parentNode}if(r)r.setAttribute("src",o);else{const s=document.createElement("iframe");s.src=o,s.width="560",s.height="315",s.className="max-w-full rounded shadow-sm",s.setAttribute("frameborder","0"),s.setAttribute("allowfullscreen","true"),s.setAttribute("sandbox","allow-scripts allow-same-origin allow-presentation"),a.deleteContents(),a.insertNode(s);const i=document.createRange();i.setStartAfter(s),i.collapse(!0),n.removeAllRanges(),n.addRange(i)}Ne=null},Dn=({isOpen:o,onClose:n,onInsert:a,initialData:r})=>{const[l,s]=b.useState(""),[i,u]=b.useState("");b.useEffect(()=>{o&&r?(s(r.url),u(r.text)):o&&!r&&(s(""),u(""))},[o,r]);const m=f=>{f.preventDefault(),l.trim()&&(a(l.trim(),i.trim()),s(""),u(""),n())};return o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:r?"Edit Link":"Insert Link"}),e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:e.jsx(He,{size:20})})]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL"}),e.jsx("input",{type:"url",value:l,onChange:f=>s(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com",required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link Text (optional)"}),e.jsx("input",{type:"text",value:i,onChange:f=>u(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Link text"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:r?"Update Link":"Insert Link"})]})]})]})}):null},In=({isOpen:o,onClose:n,onInsert:a,initialData:r})=>{const[l,s]=b.useState(""),[i,u]=b.useState(""),m=b.useRef(null);b.useEffect(()=>{o&&r?(s(r.alt),u(r.src)):o&&!r&&(s(""),u(""))},[o,r]);const f=g=>{const E=g.target.files?.[0];if(E){const C=new FileReader;C.onload=N=>{const j=N.target?.result;a(j,l||E.name),s(""),u(""),n(),m.current&&(m.current.value="")},C.readAsDataURL(E)}},T=()=>{r&&i&&(a(i,l),s(""),u(""),n())},p=()=>{m.current&&m.current.click()};return o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:r?"Edit Image":"Insert Image"}),e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:e.jsx(He,{size:20})})]}),r&&e.jsxs("div",{className:"mb-4",children:[e.jsx("img",{src:i,alt:l,className:"max-w-full h-32 object-contain rounded border"}),e.jsx("button",{type:"button",onClick:p,className:"mt-2 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Replace Image"})]}),e.jsx("input",{ref:m,type:"file",accept:"image/*",onChange:f,className:"hidden"}),!r&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image File"}),e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alt Text (optional)"}),e.jsx("input",{type:"text",value:l,onChange:g=>s(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Image description",autoFocus:!!r})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),r&&e.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Update Image"})]})]})}):null},Pn=({isOpen:o,onClose:n,onInsert:a,initialData:r})=>{const[l,s]=b.useState(""),[i,u]=b.useState("");b.useEffect(()=>{o&&r?s(r.src):o&&!r&&s(""),u("")},[o,r]);const m=T=>{const p=T.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([\w-]+)/);if(p)return`https://www.youtube.com/embed/${p[1]}`;const g=T.match(/vimeo\.com\/(?:video\/)?(\d+)/);return g?`https://player.vimeo.com/video/${g[1]}`:T.includes("youtube.com/embed/")||T.includes("player.vimeo.com/video/")?T:null},f=T=>{if(T.preventDefault(),u(""),l.trim()){const p=m(l.trim());p?(a(p),s(""),n()):u("Invalid URL. Only YouTube and Vimeo are supported for security.")}};return o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:r?"Edit Video":"Insert Video"}),e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:e.jsx(He,{size:20})})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Video URL"}),e.jsx("input",{type:"url",value:l,onChange:T=>s(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"YouTube, Vimeo, or embed URL",required:!0,autoFocus:!0}),i&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:i}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supports YouTube, Vimeo, and direct embed URLs"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:r?"Update Video":"Insert Video"})]})]})]})}):null},Hn=()=>{const[o,n]=b.useState(!1),[a,r]=b.useState(!1),[l,s]=b.useState(!1),[i,u]=b.useState(null),m=()=>{Qe();const p=et();u(p?.type==="link"?p:null),n(!0)},f=()=>{Qe();const p=et();u(p?.type==="image"?p:null),r(!0)},T=()=>{Qe();const p=et();u(p?.type==="video"?p:null),s(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:m,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Link",children:e.jsx(Nn,{size:18})}),e.jsx("button",{onClick:f,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Image",children:e.jsx(yn,{size:18})}),e.jsx("button",{onClick:T,className:"p-2 rounded transition-colors hover:bg-gray-200",title:"Insert Video",children:e.jsx(kn,{size:18})})]}),e.jsx(Dn,{isOpen:o,onClose:()=>{n(!1),u(null)},onInsert:jn,initialData:i?.type==="link"?{url:i.url,text:i.text}:null}),e.jsx(In,{isOpen:a,onClose:()=>{r(!1),u(null)},onInsert:Mn,initialData:i?.type==="image"?{src:i.src,alt:i.alt}:null}),e.jsx(Pn,{isOpen:l,onClose:()=>{s(!1),u(null)},onInsert:On,initialData:i?.type==="video"?{src:i.src}:null})]})},zn=({getButtonClass:o,onUndo:n,onRedo:a,canUndo:r,canRedo:l})=>{const s=u=>{u.preventDefault(),r&&n()},i=u=>{u.preventDefault(),l&&a()};return e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onMouseDown:s,className:`${o(!1)} ${r?"":"opacity-50 cursor-not-allowed"}`,title:"Undo",disabled:!r,children:e.jsx(Cn,{size:18})}),e.jsx("button",{onMouseDown:i,className:`${o(!1)} ${l?"":"opacity-50 cursor-not-allowed"}`,title:"Redo",disabled:!l,children:e.jsx(An,{size:18})})]})},Un=({getButtonClass:o,updateActiveFormats:n})=>{const[a,r]=b.useState(!1),[l,s]=b.useState(!1),[i,u]=b.useState(!1),[m,f]=b.useState(""),T=["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff","#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff","#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc","#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd","#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0","#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],p=[{name:"Sans Serif",value:"Arial, Helvetica, sans-serif"},{name:"Serif",value:"Times New Roman, Times, serif"},{name:"Monospace",value:"Courier New, Courier, monospace"}],g=[8,9,10,11,12,14,18,24,30,36,48,60,72,96],E=S=>{document.execCommand("foreColor",!1,S),r(!1),n()},C=S=>{document.execCommand("fontName",!1,S),s(!1),n()},N=S=>{document.execCommand("fontSize",!1,"7");const U=document.getElementsByTagName("font");for(let K=U.length-1;K>=0;K--){const L=U[K];if(L.getAttribute("size")==="7"){const $=document.createElement("span");$.style.fontSize=`${S}px`,$.innerHTML=L.innerHTML,L.parentNode?.replaceChild($,L)}}u(!1),f(""),n()},j=S=>{S.preventDefault(),m&&N(m)};return e.jsxs("div",{className:"flex gap-1 items-center relative",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>s(!l),onBlur:()=>setTimeout(()=>s(!1),200),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[100px] justify-between transition-colors",title:"Font Family",children:[e.jsx("span",{className:"font-medium truncate max-w-[80px]",children:"Font"}),e.jsx(Pe,{size:14,className:"text-gray-500"})]}),l&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 min-w-[160px]",children:p.map(S=>e.jsx("button",{onMouseDown:U=>{U.preventDefault(),C(S.value)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 font-medium",style:{fontFamily:S.value},children:S.name},S.name))})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>u(!i),onBlur:()=>{setTimeout(()=>{u(!1)},200)},className:"flex items-center gap-2 px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[60px] justify-between transition-colors",title:"Font Size",children:[e.jsx("span",{className:"font-medium",children:"Size"}),e.jsx(Pe,{size:14,className:"text-gray-500"})]}),i&&e.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 min-w-[100px] max-h-[300px] overflow-y-auto",onMouseDown:S=>S.preventDefault(),children:[e.jsx("div",{className:"p-2 border-b border-gray-100",children:e.jsxs("form",{onSubmit:j,className:"flex gap-1",children:[e.jsx("input",{type:"number",value:m,onChange:S=>f(S.target.value),placeholder:"px",className:"w-12 text-sm border border-gray-300 rounded px-1",onMouseDown:S=>S.stopPropagation()}),e.jsx("button",{type:"submit",className:"text-xs bg-blue-50 text-blue-600 px-1 rounded",children:"Go"})]})}),g.map(S=>e.jsx("button",{onMouseDown:U=>{U.preventDefault(),N(S)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-gray-700 hover:text-blue-600",children:S},S))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>r(!a),onBlur:()=>setTimeout(()=>r(!1),200),className:o(a),title:"Text Color",children:e.jsx(_n,{size:18})}),a&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 p-2 w-[180px] flex flex-wrap gap-1",children:T.map(S=>e.jsx("button",{onMouseDown:U=>{U.preventDefault(),E(S)},className:"w-5 h-5 rounded border border-gray-300 hover:scale-110 transition-transform",style:{backgroundColor:S},title:S},S))})]})]})},Fn=({getButtonClass:o})=>{const[n,a]=b.useState(!1),[r,l]=b.useState(2),[s,i]=b.useState(2),u=m=>{m.preventDefault();let f='<table style="border-collapse: collapse; width: 100%; border: 1px solid #ccc;">';f+="<tbody>";for(let T=0;T<r;T++){f+="<tr>";for(let p=0;p<s;p++)f+='<td style="border: 1px solid #ccc; padding: 8px; min-width: 50px;">&nbsp;</td>';f+="</tr>"}f+="</tbody></table><p>&nbsp;</p>",document.execCommand("insertHTML",!1,f),a(!1)};return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>a(!n),className:o(n),title:"Insert Table",children:e.jsx(Sn,{size:18})}),n&&e.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 p-4 w-64",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Insert Table"}),e.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(He,{size:16})})]}),e.jsxs("form",{onSubmit:u,children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Rows"}),e.jsx("input",{type:"number",min:"1",max:"10",value:r,onChange:m=>l(parseInt(m.target.value)||1),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Columns"}),e.jsx("input",{type:"number",min:"1",max:"10",value:s,onChange:m=>i(parseInt(m.target.value)||1),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 outline-none"})]})]}),e.jsx("button",{type:"submit",className:"w-full py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"Insert"})]})]})]})},Wn=({config:o,activeFormats:n,currentTextFormat:a,updateActiveFormats:r,applyTextFormat:l,editorRef:s,undo:i,redo:u,canUndo:m,canRedo:f})=>{const[T,p]=b.useState(!1),g=N=>`p-2 rounded transition-colors ${N?"bg-blue-100 text-blue-600 hover:bg-blue-200":"text-gray-600 hover:bg-gray-100"}`,E=()=>e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),C=[{value:"p",label:"Normal text",tag:"p"},{value:"h1",label:"Title",tag:"h1"},{value:"h2",label:"Subtitle",tag:"h2"},{value:"h3",label:"Heading 1",tag:"h3"},{value:"h4",label:"Heading 2",tag:"h4"},{value:"h5",label:"Heading 3",tag:"h5"},{value:"h6",label:"Heading 4",tag:"h6"}];return e.jsx("div",{className:"sticky top-0 z-50 w-full bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-center border",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-1 max-w-7xl mx-auto w-full",children:[e.jsx(zn,{getButtonClass:g,onUndo:i,onRedo:u,canUndo:m,canRedo:f}),e.jsx(E,{}),o.showTextFormat&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>p(!T),onBlur:()=>setTimeout(()=>p(!1),200),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded min-w-[130px] justify-between transition-colors",children:[e.jsx("span",{className:"font-medium truncate max-w-[100px]",children:C.find(N=>N.value===a)?.label||"Normal text"}),e.jsx(Pe,{size:14,className:"text-gray-500"})]}),T&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 min-w-[160px] max-h-[300px] overflow-y-auto w-full",children:C.map(N=>e.jsx("button",{onMouseDown:j=>{j.preventDefault(),l(N.tag)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-50 ${a===N.value?"bg-blue-50 text-blue-600 font-medium":"text-gray-700"}`,children:e.jsx("span",{className:N.tag==="p"?"":N.tag==="h1"?"text-2xl font-bold":N.tag==="h2"?"text-xl font-bold":N.tag==="h3"?"text-lg font-bold":"font-bold",children:N.label})},N.value))})]}),e.jsx(E,{})]}),e.jsx(Un,{getButtonClass:g,updateActiveFormats:r}),e.jsx(E,{}),o.showInlineFormat&&e.jsxs(e.Fragment,{children:[e.jsx(At,{editorRef:s,activeFormats:{bold:n.bold,italic:n.italic,underline:n.underline,strikethrough:n.strikethrough},updateActiveFormats:r,getButtonClass:g}),e.jsx(E,{})]}),o.showAlignment&&e.jsxs(e.Fragment,{children:[e.jsx(vt,{activeFormats:{alignLeft:n.alignLeft,alignCenter:n.alignCenter,alignRight:n.alignRight,alignJustify:n.alignJustify},updateActiveFormats:r,getButtonClass:g}),e.jsx(E,{})]}),o.showList&&e.jsxs(e.Fragment,{children:[e.jsx(Rt,{editorRef:s,activeFormats:{bulletList:n.bulletList,numberedList:n.numberedList},updateActiveFormats:r,getButtonClass:g}),e.jsx(E,{})]}),o.showInsert&&e.jsxs(e.Fragment,{children:[e.jsx(Hn,{}),e.jsx(Fn,{getButtonClass:g})]})]})})};/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Ct,setPrototypeOf:kt,isFrozen:Gn,getPrototypeOf:Yn,getOwnPropertyDescriptor:Bn}=Object;let{freeze:X,seal:ne,create:tt}=Object,{apply:nt,construct:ot}=typeof Reflect<"u"&&Reflect;X||(X=function(n){return n}),ne||(ne=function(n){return n}),nt||(nt=function(n,a){for(var r=arguments.length,l=new Array(r>2?r-2:0),s=2;s<r;s++)l[s-2]=arguments[s];return n.apply(a,l)}),ot||(ot=function(n){for(var a=arguments.length,r=new Array(a>1?a-1:0),l=1;l<a;l++)r[l-1]=arguments[l];return new n(...r)});const Fe=Z(Array.prototype.forEach),Vn=Z(Array.prototype.lastIndexOf),Lt=Z(Array.prototype.pop),ke=Z(Array.prototype.push),Xn=Z(Array.prototype.splice),We=Z(String.prototype.toLowerCase),rt=Z(String.prototype.toString),st=Z(String.prototype.match),Le=Z(String.prototype.replace),Jn=Z(String.prototype.indexOf),Zn=Z(String.prototype.trim),re=Z(Object.prototype.hasOwnProperty),J=Z(RegExp.prototype.test),je=Kn(TypeError);function Z(o){return function(n){n instanceof RegExp&&(n.lastIndex=0);for(var a=arguments.length,r=new Array(a>1?a-1:0),l=1;l<a;l++)r[l-1]=arguments[l];return nt(o,n,r)}}function Kn(o){return function(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return ot(o,a)}}function _(o,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:We;kt&&kt(o,null);let r=n.length;for(;r--;){let l=n[r];if(typeof l=="string"){const s=a(l);s!==l&&(Gn(n)||(n[r]=s),l=s)}o[l]=!0}return o}function $n(o){for(let n=0;n<o.length;n++)re(o,n)||(o[n]=null);return o}function ae(o){const n=tt(null);for(const[a,r]of Ct(o))re(o,a)&&(Array.isArray(r)?n[a]=$n(r):r&&typeof r=="object"&&r.constructor===Object?n[a]=ae(r):n[a]=r);return n}function Me(o,n){for(;o!==null;){const r=Bn(o,n);if(r){if(r.get)return Z(r.get);if(typeof r.value=="function")return Z(r.value)}o=Yn(o)}function a(){return null}return a}const jt=X(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),at=X(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lt=X(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Qn=X(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),it=X(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),qn=X(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Mt=X(["#text"]),Ot=X(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ct=X(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Dt=X(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ge=X(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),eo=ne(/\{\{[\w\W]*|[\w\W]*\}\}/gm),to=ne(/<%[\w\W]*|[\w\W]*%>/gm),no=ne(/\$\{[\w\W]*/gm),oo=ne(/^data-[\-\w.\u00B7-\uFFFF]+$/),ro=ne(/^aria-[\-\w]+$/),It=ne(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),so=ne(/^(?:\w+script|data):/i),ao=ne(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pt=ne(/^html$/i),lo=ne(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ht=Object.freeze({__proto__:null,ARIA_ATTR:ro,ATTR_WHITESPACE:ao,CUSTOM_ELEMENT:lo,DATA_ATTR:oo,DOCTYPE_NAME:Pt,ERB_EXPR:to,IS_ALLOWED_URI:It,IS_SCRIPT_OR_DATA:so,MUSTACHE_EXPR:eo,TMPLIT_EXPR:no});const Oe={element:1,text:3,progressingInstruction:7,comment:8,document:9},io=function(){return typeof window>"u"?null:window},co=function(n,a){if(typeof n!="object"||typeof n.createPolicy!="function")return null;let r=null;const l="data-tt-policy-suffix";a&&a.hasAttribute(l)&&(r=a.getAttribute(l));const s="dompurify"+(r?"#"+r:"");try{return n.createPolicy(s,{createHTML(i){return i},createScriptURL(i){return i}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},zt=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ut(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:io();const n=y=>Ut(y);if(n.version="3.3.1",n.removed=[],!o||!o.document||o.document.nodeType!==Oe.document||!o.Element)return n.isSupported=!1,n;let{document:a}=o;const r=a,l=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:i,Node:u,Element:m,NodeFilter:f,NamedNodeMap:T=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:p,DOMParser:g,trustedTypes:E}=o,C=m.prototype,N=Me(C,"cloneNode"),j=Me(C,"remove"),S=Me(C,"nextSibling"),U=Me(C,"childNodes"),K=Me(C,"parentNode");if(typeof i=="function"){const y=a.createElement("template");y.content&&y.content.ownerDocument&&(a=y.content.ownerDocument)}let L,$="";const{implementation:ge,createNodeIterator:oe,createDocumentFragment:he,getElementsByTagName:A}=a,{importNode:F}=r;let w=zt();n.isSupported=typeof Ct=="function"&&typeof K=="function"&&ge&&ge.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:W,ERB_EXPR:G,TMPLIT_EXPR:I,DATA_ATTR:D,ARIA_ATTR:Y,IS_SCRIPT_OR_DATA:Q,ATTR_WHITESPACE:q,CUSTOM_ELEMENT:te}=Ht;let{IS_ALLOWED_URI:c}=Ht,h=null;const R=_({},[...jt,...at,...lt,...it,...Mt]);let v=null;const se=_({},[...Ot,...ct,...Dt,...Ge]);let k=Object.seal(tt(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ce=null,xe=null;const O=Object.seal(tt(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ue=!0,be=!0,Ye=!1,Ft=!0,Te=!1,Be=!0,ye=!1,ut=!1,dt=!1,we=!1,Ve=!1,Xe=!1,Wt=!0,Gt=!1;const xo="user-content-";let mt=!0,De=!1,_e={},le=null;const ft=_({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Yt=null;const Bt=_({},["audio","video","img","source","image","track"]);let pt=null;const Vt=_({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Je="http://www.w3.org/1998/Math/MathML",Ze="http://www.w3.org/2000/svg",de="http://www.w3.org/1999/xhtml";let Ae=de,gt=!1,ht=null;const bo=_({},[Je,Ze,de],rt);let Ke=_({},["mi","mo","mn","ms","mtext"]),$e=_({},["annotation-xml"]);const yo=_({},["title","style","font","a","script"]);let Ie=null;const Eo=["application/xhtml+xml","text/html"],No="text/html";let z=null,ve=null;const To=a.createElement("form"),Xt=function(t){return t instanceof RegExp||t instanceof Function},xt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ve&&ve===t)){if((!t||typeof t!="object")&&(t={}),t=ae(t),Ie=Eo.indexOf(t.PARSER_MEDIA_TYPE)===-1?No:t.PARSER_MEDIA_TYPE,z=Ie==="application/xhtml+xml"?rt:We,h=re(t,"ALLOWED_TAGS")?_({},t.ALLOWED_TAGS,z):R,v=re(t,"ALLOWED_ATTR")?_({},t.ALLOWED_ATTR,z):se,ht=re(t,"ALLOWED_NAMESPACES")?_({},t.ALLOWED_NAMESPACES,rt):bo,pt=re(t,"ADD_URI_SAFE_ATTR")?_(ae(Vt),t.ADD_URI_SAFE_ATTR,z):Vt,Yt=re(t,"ADD_DATA_URI_TAGS")?_(ae(Bt),t.ADD_DATA_URI_TAGS,z):Bt,le=re(t,"FORBID_CONTENTS")?_({},t.FORBID_CONTENTS,z):ft,ce=re(t,"FORBID_TAGS")?_({},t.FORBID_TAGS,z):ae({}),xe=re(t,"FORBID_ATTR")?_({},t.FORBID_ATTR,z):ae({}),_e=re(t,"USE_PROFILES")?t.USE_PROFILES:!1,ue=t.ALLOW_ARIA_ATTR!==!1,be=t.ALLOW_DATA_ATTR!==!1,Ye=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ft=t.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=t.SAFE_FOR_TEMPLATES||!1,Be=t.SAFE_FOR_XML!==!1,ye=t.WHOLE_DOCUMENT||!1,we=t.RETURN_DOM||!1,Ve=t.RETURN_DOM_FRAGMENT||!1,Xe=t.RETURN_TRUSTED_TYPE||!1,dt=t.FORCE_BODY||!1,Wt=t.SANITIZE_DOM!==!1,Gt=t.SANITIZE_NAMED_PROPS||!1,mt=t.KEEP_CONTENT!==!1,De=t.IN_PLACE||!1,c=t.ALLOWED_URI_REGEXP||It,Ae=t.NAMESPACE||de,Ke=t.MATHML_TEXT_INTEGRATION_POINTS||Ke,$e=t.HTML_INTEGRATION_POINTS||$e,k=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&Xt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(k.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&Xt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(k.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(k.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(be=!1),Ve&&(we=!0),_e&&(h=_({},Mt),v=[],_e.html===!0&&(_(h,jt),_(v,Ot)),_e.svg===!0&&(_(h,at),_(v,ct),_(v,Ge)),_e.svgFilters===!0&&(_(h,lt),_(v,ct),_(v,Ge)),_e.mathMl===!0&&(_(h,it),_(v,Dt),_(v,Ge))),t.ADD_TAGS&&(typeof t.ADD_TAGS=="function"?O.tagCheck=t.ADD_TAGS:(h===R&&(h=ae(h)),_(h,t.ADD_TAGS,z))),t.ADD_ATTR&&(typeof t.ADD_ATTR=="function"?O.attributeCheck=t.ADD_ATTR:(v===se&&(v=ae(v)),_(v,t.ADD_ATTR,z))),t.ADD_URI_SAFE_ATTR&&_(pt,t.ADD_URI_SAFE_ATTR,z),t.FORBID_CONTENTS&&(le===ft&&(le=ae(le)),_(le,t.FORBID_CONTENTS,z)),t.ADD_FORBID_CONTENTS&&(le===ft&&(le=ae(le)),_(le,t.ADD_FORBID_CONTENTS,z)),mt&&(h["#text"]=!0),ye&&_(h,["html","head","body"]),h.table&&(_(h,["tbody"]),delete ce.tbody),t.TRUSTED_TYPES_POLICY){if(typeof t.TRUSTED_TYPES_POLICY.createHTML!="function")throw je('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof t.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw je('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');L=t.TRUSTED_TYPES_POLICY,$=L.createHTML("")}else L===void 0&&(L=co(E,l)),L!==null&&typeof $=="string"&&($=L.createHTML(""));X&&X(t),ve=t}},Jt=_({},[...at,...lt,...Qn]),Zt=_({},[...it,...qn]),wo=function(t){let d=K(t);(!d||!d.tagName)&&(d={namespaceURI:Ae,tagName:"template"});const x=We(t.tagName),M=We(d.tagName);return ht[t.namespaceURI]?t.namespaceURI===Ze?d.namespaceURI===de?x==="svg":d.namespaceURI===Je?x==="svg"&&(M==="annotation-xml"||Ke[M]):!!Jt[x]:t.namespaceURI===Je?d.namespaceURI===de?x==="math":d.namespaceURI===Ze?x==="math"&&$e[M]:!!Zt[x]:t.namespaceURI===de?d.namespaceURI===Ze&&!$e[M]||d.namespaceURI===Je&&!Ke[M]?!1:!Zt[x]&&(yo[x]||!Jt[x]):!!(Ie==="application/xhtml+xml"&&ht[t.namespaceURI]):!1},ie=function(t){ke(n.removed,{element:t});try{K(t).removeChild(t)}catch{j(t)}},Ee=function(t,d){try{ke(n.removed,{attribute:d.getAttributeNode(t),from:d})}catch{ke(n.removed,{attribute:null,from:d})}if(d.removeAttribute(t),t==="is")if(we||Ve)try{ie(d)}catch{}else try{d.setAttribute(t,"")}catch{}},Kt=function(t){let d=null,x=null;if(dt)t="<remove></remove>"+t;else{const P=st(t,/^[\r\n\t ]+/);x=P&&P[0]}Ie==="application/xhtml+xml"&&Ae===de&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const M=L?L.createHTML(t):t;if(Ae===de)try{d=new g().parseFromString(M,Ie)}catch{}if(!d||!d.documentElement){d=ge.createDocument(Ae,"template",null);try{d.documentElement.innerHTML=gt?$:M}catch{}}const V=d.body||d.documentElement;return t&&x&&V.insertBefore(a.createTextNode(x),V.childNodes[0]||null),Ae===de?A.call(d,ye?"html":"body")[0]:ye?d.documentElement:V},$t=function(t){return oe.call(t.ownerDocument||t,t,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},bt=function(t){return t instanceof p&&(typeof t.nodeName!="string"||typeof t.textContent!="string"||typeof t.removeChild!="function"||!(t.attributes instanceof T)||typeof t.removeAttribute!="function"||typeof t.setAttribute!="function"||typeof t.namespaceURI!="string"||typeof t.insertBefore!="function"||typeof t.hasChildNodes!="function")},Qt=function(t){return typeof u=="function"&&t instanceof u};function me(y,t,d){Fe(y,x=>{x.call(n,t,d,ve)})}const qt=function(t){let d=null;if(me(w.beforeSanitizeElements,t,null),bt(t))return ie(t),!0;const x=z(t.nodeName);if(me(w.uponSanitizeElement,t,{tagName:x,allowedTags:h}),Be&&t.hasChildNodes()&&!Qt(t.firstElementChild)&&J(/<[/\w!]/g,t.innerHTML)&&J(/<[/\w!]/g,t.textContent)||t.nodeType===Oe.progressingInstruction||Be&&t.nodeType===Oe.comment&&J(/<[/\w]/g,t.data))return ie(t),!0;if(!(O.tagCheck instanceof Function&&O.tagCheck(x))&&(!h[x]||ce[x])){if(!ce[x]&&tn(x)&&(k.tagNameCheck instanceof RegExp&&J(k.tagNameCheck,x)||k.tagNameCheck instanceof Function&&k.tagNameCheck(x)))return!1;if(mt&&!le[x]){const M=K(t)||t.parentNode,V=U(t)||t.childNodes;if(V&&M){const P=V.length;for(let ee=P-1;ee>=0;--ee){const fe=N(V[ee],!0);fe.__removalCount=(t.__removalCount||0)+1,M.insertBefore(fe,S(t))}}}return ie(t),!0}return t instanceof m&&!wo(t)||(x==="noscript"||x==="noembed"||x==="noframes")&&J(/<\/no(script|embed|frames)/i,t.innerHTML)?(ie(t),!0):(Te&&t.nodeType===Oe.text&&(d=t.textContent,Fe([W,G,I],M=>{d=Le(d,M," ")}),t.textContent!==d&&(ke(n.removed,{element:t.cloneNode()}),t.textContent=d)),me(w.afterSanitizeElements,t,null),!1)},en=function(t,d,x){if(Wt&&(d==="id"||d==="name")&&(x in a||x in To))return!1;if(!(be&&!xe[d]&&J(D,d))){if(!(ue&&J(Y,d))){if(!(O.attributeCheck instanceof Function&&O.attributeCheck(d,t))){if(!v[d]||xe[d]){if(!(tn(t)&&(k.tagNameCheck instanceof RegExp&&J(k.tagNameCheck,t)||k.tagNameCheck instanceof Function&&k.tagNameCheck(t))&&(k.attributeNameCheck instanceof RegExp&&J(k.attributeNameCheck,d)||k.attributeNameCheck instanceof Function&&k.attributeNameCheck(d,t))||d==="is"&&k.allowCustomizedBuiltInElements&&(k.tagNameCheck instanceof RegExp&&J(k.tagNameCheck,x)||k.tagNameCheck instanceof Function&&k.tagNameCheck(x))))return!1}else if(!pt[d]){if(!J(c,Le(x,q,""))){if(!((d==="src"||d==="xlink:href"||d==="href")&&t!=="script"&&Jn(x,"data:")===0&&Yt[t])){if(!(Ye&&!J(Q,Le(x,q,"")))){if(x)return!1}}}}}}}return!0},tn=function(t){return t!=="annotation-xml"&&st(t,te)},nn=function(t){me(w.beforeSanitizeAttributes,t,null);const{attributes:d}=t;if(!d||bt(t))return;const x={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let M=d.length;for(;M--;){const V=d[M],{name:P,namespaceURI:ee,value:fe}=V,Se=z(P),yt=fe;let B=P==="value"?yt:Zn(yt);if(x.attrName=Se,x.attrValue=B,x.keepAttr=!0,x.forceKeepAttr=void 0,me(w.uponSanitizeAttribute,t,x),B=x.attrValue,Gt&&(Se==="id"||Se==="name")&&(Ee(P,t),B=xo+B),Be&&J(/((--!?|])>)|<\/(style|title|textarea)/i,B)){Ee(P,t);continue}if(Se==="attributename"&&st(B,"href")){Ee(P,t);continue}if(x.forceKeepAttr)continue;if(!x.keepAttr){Ee(P,t);continue}if(!Ft&&J(/\/>/i,B)){Ee(P,t);continue}Te&&Fe([W,G,I],rn=>{B=Le(B,rn," ")});const on=z(t.nodeName);if(!en(on,Se,B)){Ee(P,t);continue}if(L&&typeof E=="object"&&typeof E.getAttributeType=="function"&&!ee)switch(E.getAttributeType(on,Se)){case"TrustedHTML":{B=L.createHTML(B);break}case"TrustedScriptURL":{B=L.createScriptURL(B);break}}if(B!==yt)try{ee?t.setAttributeNS(ee,P,B):t.setAttribute(P,B),bt(t)?ie(t):Lt(n.removed)}catch{Ee(P,t)}}me(w.afterSanitizeAttributes,t,null)},_o=function y(t){let d=null;const x=$t(t);for(me(w.beforeSanitizeShadowDOM,t,null);d=x.nextNode();)me(w.uponSanitizeShadowNode,d,null),qt(d),nn(d),d.content instanceof s&&y(d.content);me(w.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(y){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=null,x=null,M=null,V=null;if(gt=!y,gt&&(y="<!-->"),typeof y!="string"&&!Qt(y))if(typeof y.toString=="function"){if(y=y.toString(),typeof y!="string")throw je("dirty is not a string, aborting")}else throw je("toString is not a function");if(!n.isSupported)return y;if(ut||xt(t),n.removed=[],typeof y=="string"&&(De=!1),De){if(y.nodeName){const fe=z(y.nodeName);if(!h[fe]||ce[fe])throw je("root node is forbidden and cannot be sanitized in-place")}}else if(y instanceof u)d=Kt("<!---->"),x=d.ownerDocument.importNode(y,!0),x.nodeType===Oe.element&&x.nodeName==="BODY"||x.nodeName==="HTML"?d=x:d.appendChild(x);else{if(!we&&!Te&&!ye&&y.indexOf("<")===-1)return L&&Xe?L.createHTML(y):y;if(d=Kt(y),!d)return we?null:Xe?$:""}d&&dt&&ie(d.firstChild);const P=$t(De?y:d);for(;M=P.nextNode();)qt(M),nn(M),M.content instanceof s&&_o(M.content);if(De)return y;if(we){if(Ve)for(V=he.call(d.ownerDocument);d.firstChild;)V.appendChild(d.firstChild);else V=d;return(v.shadowroot||v.shadowrootmode)&&(V=F.call(r,V,!0)),V}let ee=ye?d.outerHTML:d.innerHTML;return ye&&h["!doctype"]&&d.ownerDocument&&d.ownerDocument.doctype&&d.ownerDocument.doctype.name&&J(Pt,d.ownerDocument.doctype.name)&&(ee="<!DOCTYPE "+d.ownerDocument.doctype.name+`>
`+ee),Te&&Fe([W,G,I],fe=>{ee=Le(ee,fe," ")}),L&&Xe?L.createHTML(ee):ee},n.setConfig=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xt(y),ut=!0},n.clearConfig=function(){ve=null,ut=!1},n.isValidAttribute=function(y,t,d){ve||xt({});const x=z(y),M=z(t);return en(x,M,d)},n.addHook=function(y,t){typeof t=="function"&&ke(w[y],t)},n.removeHook=function(y,t){if(t!==void 0){const d=Vn(w[y],t);return d===-1?void 0:Xn(w[y],d,1)[0]}return Lt(w[y])},n.removeHooks=function(y){w[y]=[]},n.removeAllHooks=function(){w=zt()},n}var uo=Ut();const mo=o=>{const[n,a]=b.useState([{html:o}]),[r,l]=b.useState(0),s=b.useRef(null),i=b.useCallback((p,g=!1)=>{if(s.current&&clearTimeout(s.current),g){a(E=>E[r].html===p?E:[...E.slice(0,r+1),{html:p}]),l(E=>E+1);return}s.current=setTimeout(()=>{a(E=>E[r].html===p?E:[...E.slice(0,r+1),{html:p}]),l(E=>E+1)},500)},[r]),u=b.useCallback(()=>{if(r>0){const p=r-1;return l(p),n[p].html}return null},[r,n]),m=b.useCallback(()=>{if(r<n.length-1){const p=r+1;return l(p),n[p].html}return null},[r,n]),f=r>0,T=r<n.length-1;return{history:n,pointer:r,pushState:i,undo:u,redo:m,canUndo:f,canRedo:T}},fo=({paddingLeft:o,paddingRight:n,onChange:a})=>{const r=b.useRef(null),[l,s]=b.useState(null),i=[];for(let g=0;g<=90;g++){const E=g*10,C=g%10===0?12:g%5===0?8:4;i.push(e.jsx("line",{x1:E,y1:20-C,x2:E,y2:20,stroke:"#ccc",strokeWidth:"1"},g)),g%10===0&&i.push(e.jsx("text",{x:E+2,y:10,fontSize:"8",fill:"#999",children:g},`text-${g}`))}const u=(g,E)=>{g.preventDefault(),s(E)},m=g=>{if(!l||!r.current)return;const E=r.current.getBoundingClientRect(),C=g.clientX-E.left,N=896;if(l==="left"){const j=Math.max(0,Math.min(C,N-n-50));a({left:j,right:n})}else{const j=Math.max(0,Math.min(N-C,N-o-50));a({left:o,right:j})}},f=()=>{s(null)};b.useEffect(()=>(l&&(document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}),[l,o,n]);const p=896-n;return e.jsx("div",{ref:r,className:"h-6 w-full bg-gray-50 border-b border-gray-300 relative select-none",children:e.jsxs("svg",{width:"100%",height:"100%",className:"absolute left-0",children:[i,e.jsx("rect",{x:"0",y:"0",width:o,height:"100%",fill:"#e5e7eb",opacity:"0.5"}),e.jsx("rect",{x:p,y:"0",width:n,height:"100%",fill:"#e5e7eb",opacity:"0.5"}),e.jsx("polygon",{points:`${o},0 ${o+6},0 ${o+6},10 ${o},20 ${o-6},10 ${o-6},0`,fill:"#3b82f6",cursor:"ew-resize",onMouseDown:g=>u(g,"left")}),e.jsx("polygon",{points:`${p},0 ${p+6},0 ${p+6},10 ${p},20 ${p-6},10 ${p-6},0`,fill:"#3b82f6",cursor:"ew-resize",onMouseDown:g=>u(g,"right")})]})})},po=({paddingTop:o,paddingBottom:n,onChange:a})=>{const r=b.useRef(null),[l,s]=b.useState(null),i=[];for(let g=0;g<=100;g++){const E=g*10,C=g%10===0?12:g%5===0?8:4;i.push(e.jsx("line",{x1:20-C,y1:E,x2:20,y2:E,stroke:"#ccc",strokeWidth:"1"},g)),g%10===0&&g!==0&&i.push(e.jsx("text",{x:2,y:E+8,fontSize:"8",fill:"#999",className:"rotate-[-90deg] origin-center",children:g},`text-${g}`))}const u=(g,E)=>{g.preventDefault(),s(E)},m=g=>{if(!l||!r.current)return;const E=r.current.getBoundingClientRect(),C=1123,N=g.clientY-E.top;if(l==="top"){const j=Math.max(0,Math.min(N,C-n-50));a({top:j,bottom:n})}else{const j=Math.max(0,Math.min(C-N,C-o-50));a({top:o,bottom:j})}},f=()=>{s(null)};b.useEffect(()=>(l&&(document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}),[l,o,n]);const p=1123-n;return e.jsx("div",{ref:r,className:"w-6 h-full bg-gray-50 border-r border-gray-300 relative select-none flex-shrink-0",children:e.jsxs("svg",{width:"100%",height:"2000px",className:"absolute top-0",children:[i,e.jsx("rect",{x:"0",y:"0",width:"100%",height:o,fill:"#e5e7eb",opacity:"0.5"}),e.jsx("rect",{x:"0",y:p,width:"100%",height:n,fill:"#e5e7eb",opacity:"0.5"}),e.jsx("polygon",{points:`0,${o} 0,${o+6} 10,${o+6} 20,${o} 10,${o-6} 0,${o-6}`,fill:"#3b82f6",cursor:"ns-resize",onMouseDown:g=>u(g,"top")}),e.jsx("polygon",{points:`0,${p} 0,${p+6} 10,${p+6} 20,${p} 10,${p-6} 0,${p-6}`,fill:"#3b82f6",cursor:"ns-resize",onMouseDown:g=>u(g,"bottom")})]})})},go=({content:o="",onChange:n,onBlur:a,onFocus:r,config:l={showTextFormat:!0,showInlineFormat:!0,showAlignment:!0,showList:!0,showInsert:!0}})=>{const s=b.useRef(null),[i,u]=b.useState({bold:!1,italic:!1,underline:!1,strikethrough:!1,alignLeft:!1,alignCenter:!1,alignRight:!1,alignJustify:!1,bulletList:!1,numberedList:!1}),[m,f]=b.useState({top:40,right:40,bottom:40,left:40}),[T,p]=b.useState("p"),{pushState:g,undo:E,redo:C,canUndo:N,canRedo:j}=mo(o),S=()=>{const A=E();A!==null&&s.current&&(s.current.innerHTML=A,n&&n(A),oe())},U=()=>{const A=C();A!==null&&s.current&&(s.current.innerHTML=A,n&&n(A),oe())},K=A=>{const F=window.getSelection();if(!F||F.rangeCount===0)return;const w=F.getRangeAt(0);let W=w.commonAncestorContainer;W.nodeType===Node.TEXT_NODE&&(W=W.parentNode);let G=null,I=W;for(;I&&I!==s.current;){if(I.nodeType===Node.ELEMENT_NODE){const D=I,Y=D.tagName.toLowerCase();if(["p","h1","h2","h3","h4","h5","h6","div"].includes(Y)){G=D;break}}I=I.parentNode}if(G&&G!==s.current){const D=document.createElement(A);D.innerHTML=G.innerHTML,G.style.textAlign&&(D.style.textAlign=G.style.textAlign),G.parentNode?.replaceChild(D,G),p(A);const Y=document.createRange();Y.selectNodeContents(D),F.removeAllRanges(),F.addRange(Y)}else{const D=document.createElement(A);if(w.toString())try{w.surroundContents(D)}catch{const Q=w.extractContents();D.appendChild(Q),w.insertNode(D)}else{D.innerHTML="<br>",w.insertNode(D);const Y=document.createRange();Y.setStart(D,0),Y.collapse(!0),F.removeAllRanges(),F.addRange(Y)}p(A)}s.current&&g(s.current.innerHTML,!0),setTimeout(()=>oe(),10)},L=()=>{if(s.current&&n){const A=s.current.innerHTML;n(A),g(A)}},$=()=>{if(a&&s.current){const A=s.current.innerHTML;a(A)}},ge=()=>{r&&r()};b.useEffect(()=>{if(s.current&&o!==void 0){const A=uo.sanitize(o);s.current.innerHTML!==A&&(s.current.innerHTML=A)}},[o]);const oe=()=>{const A=window.getSelection();if(!A||A.rangeCount===0)return;let w=A.getRangeAt(0).commonAncestorContainer;w.nodeType===Node.TEXT_NODE&&(w=w.parentNode);let W=w,G="p";for(;W&&W!==s.current;){if(["H1","H2","H3","H4","H5","H6","P"].includes(W.tagName)){G=W.tagName.toLowerCase();break}W=W.parentElement}p(G);let I=w,D=!1,Y=!1;for(;I&&I!==s.current;){if(I.tagName==="UL"){D=!0;break}else if(I.tagName==="OL"){Y=!0;break}I=I.parentElement}const Q=h=>{let R=w;for(;R&&R!==s.current;){if(R.nodeType===Node.ELEMENT_NODE&&R.tagName.toLowerCase()===h.toLowerCase())return!0;R=R.parentNode}return!1};let q=w;for(;q&&q!==s.current;){if(q.nodeType===Node.ELEMENT_NODE){const h=q.tagName.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p"].includes(h)){p(h);break}}q=q.parentNode}(q===s.current||!q)&&p("p");let te=w;for(;te&&te!==s.current&&te.nodeType!==Node.ELEMENT_NODE;)te=te.parentNode;const c=te&&te.nodeType===Node.ELEMENT_NODE?te.style.textAlign:"";u({bold:Q("strong")||Q("b"),italic:Q("em")||Q("i"),underline:Q("u"),strikethrough:Q("s")||Q("strike")||Q("del"),alignLeft:c===""||c==="left",alignCenter:c==="center",alignRight:c==="right",alignJustify:c==="justify",bulletList:D,numberedList:Y})},he=()=>{const A=window.getSelection();if(A&&A.rangeCount>0){const F=A.getRangeAt(0);s.current?.contains(F.commonAncestorContainer)&&oe()}};return b.useEffect(()=>(document.addEventListener("selectionchange",he),()=>{document.removeEventListener("selectionchange",he)}),[]),e.jsxs("div",{className:"teddy-editor w-full h-screen bg-gray-100 flex flex-col overflow-hidden",children:[e.jsx(Wn,{config:l,activeFormats:i,currentTextFormat:T,updateActiveFormats:oe,applyTextFormat:K,editorRef:s,undo:S,redo:U,canUndo:N,canRedo:j}),e.jsx("div",{className:"flex-1 overflow-auto flex justify-center p-4 relative",children:e.jsxs("div",{className:"flex flex-col gap-1 w-full max-w-4xl",children:[e.jsx("div",{className:"pl-6 select-none bg-gray-100 sticky top-0 z-10 pt-2",children:e.jsx(fo,{paddingLeft:m.left,paddingRight:m.right,onChange:({left:A,right:F})=>f(w=>({...w,left:A,right:F}))})}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"pr-1 select-none pt-0 hidden sm:block h-full relative",children:e.jsx(po,{paddingTop:m.top,paddingBottom:m.bottom,onChange:({top:A,bottom:F})=>f(w=>({...w,top:A,bottom:F}))})}),e.jsx("div",{ref:s,contentEditable:!0,className:"document-page outline-none focus:ring-0 prose prose-headings:mt-4 prose-headings:mb-2 w-full bg-white shadow-sm min-h-[1123px]",style:{whiteSpace:"pre-wrap",paddingTop:`${m.top}px`,paddingRight:`${m.right}px`,paddingBottom:`${m.bottom}px`,paddingLeft:`${m.left}px`},onMouseUp:oe,onKeyUp:oe,onInput:L,onBlur:$,onFocus:ge})]})]})}),e.jsx(Ln,{editorRef:s,activeFormats:i,currentTextFormat:T,updateActiveFormats:oe,applyTextFormat:K})]})};function ho(){return e.jsx("div",{children:e.jsx(go,{content:"<p>Initial content</p>",onChange:o=>console.log("Content changed:",o),onBlur:o=>console.log("Editor lost focus",o),onFocus:()=>console.log("Editor gained focus")})})}return ho});
